"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/lib/db-simple.ts":
/*!******************************!*\
  !*** ./src/lib/db-simple.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeConnection: () => (/* binding */ closeConnection),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(middleware)/./node_modules/mysql2/promise.js\");\n\n// Single connection approach for extremely limited hosting\nlet connection = null;\nlet connectionPromise = null;\nconst dbConfig = {\n    host: process.env.DB_HOST || \"198.38.90.50\",\n    port: parseInt(process.env.DB_PORT || \"3306\"),\n    database: process.env.DB_NAME || \"bolalooc_mazdoor\",\n    user: process.env.DB_USER || \"bolalooc_maz123\",\n    password: process.env.DB_PASSWORD || \"EsbER0JeytIXlp40\",\n    // Only valid options for mysql2 single connections\n    connectTimeout: 60000,\n    timezone: \"+00:00\"\n};\nasync function getConnection() {\n    // Reuse existing connection if available and still connected\n    if (connection) {\n        try {\n            // Test if connection is still alive with a simple query\n            await connection.query(\"SELECT 1\");\n            return connection;\n        } catch (error) {\n            // Connection is dead, clean it up\n            console.log(\"[DB] Existing connection is dead, creating new one...\");\n            try {\n                await connection.end();\n            } catch (closeError) {\n            // Ignore errors when closing dead connection\n            }\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n    // If there's already a connection being created, wait for it\n    if (connectionPromise) {\n        return connectionPromise;\n    }\n    console.log(\"[DB] Creating new database connection...\");\n    connectionPromise = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createConnection(dbConfig);\n    try {\n        connection = await connectionPromise;\n        connectionPromise = null;\n        console.log(\"[DB] Database connection established successfully\");\n        // Handle connection errors\n        connection.on(\"error\", (err)=>{\n            console.error(\"Database connection error:\", err);\n            if (err.code === \"PROTOCOL_CONNECTION_LOST\" || err.code === \"ECONNRESET\") {\n                connection = null;\n                connectionPromise = null;\n            }\n        });\n        return connection;\n    } catch (error) {\n        console.error(\"[DB] Failed to create database connection:\", error);\n        connectionPromise = null;\n        throw error;\n    }\n}\nasync function query(sql, params = []) {\n    let retries = 5; // More retries\n    let delay = 1000; // Start with shorter delay\n    for(let attempt = 1; attempt <= retries; attempt++){\n        try {\n            const conn = await getConnection();\n            // Execute query with timeout\n            const [results] = await Promise.race([\n                conn.query(sql, params),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Query timeout after 30 seconds\")), 30000))\n            ]);\n            // Keep connection alive for reuse - don't close it\n            return results;\n        } catch (error) {\n            // Only reset connection state on connection-related errors\n            if (error.code === \"PROTOCOL_CONNECTION_LOST\" || error.code === \"ECONNRESET\" || error.code === \"ER_TOO_MANY_USER_CONNECTIONS\" || error.message?.includes(\"timeout\")) {\n                connection = null;\n                connectionPromise = null;\n            }\n            console.error(`Database query error (attempt ${attempt}/${retries}):`, {\n                error: error.message,\n                code: error.code,\n                sql: sql.substring(0, 100) + (sql.length > 100 ? \"...\" : \"\")\n            });\n            if (attempt === retries) {\n                if (error.code === \"ER_TOO_MANY_USER_CONNECTIONS\") {\n                    throw new Error(\"Database connection limit reached. Your hosting provider has very strict connection limits. Please try again in a few moments or contact your hosting provider to increase the connection limit.\");\n                }\n                throw new Error(`Database error: ${error.message}`);\n            }\n            // Progressive delay with some randomness to avoid thundering herd\n            const randomDelay = delay + Math.random() * 1000;\n            console.log(`Retrying in ${randomDelay.toFixed(0)}ms...`);\n            await new Promise((resolve)=>setTimeout(resolve, randomDelay));\n            delay *= 1.2; // Slower growth\n        }\n    }\n    throw new Error(\"Max retries exceeded\");\n}\nasync function queryOne(sql, params = []) {\n    const results = await query(sql, params);\n    return results[0] || null;\n}\nasync function testConnection() {\n    try {\n        await query(\"SELECT 1 as test\");\n        return true;\n    } catch (error) {\n        console.error(\"Database connection test failed:\", error);\n        return false;\n    }\n}\nasync function closeConnection() {\n    if (connection) {\n        try {\n            await connection.end();\n            console.log(\"Database connection closed successfully\");\n        } catch (error) {\n            console.error(\"Error closing database connection:\", error);\n        } finally{\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Olsid2VicGFjazovL19OX0UvLi9zcmMvbGliL2RiLXNpbXBsZS50cz9lODAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBteXNxbCBmcm9tIFwibXlzcWwyL3Byb21pc2VcIjtcclxuXHJcbi8vIFNpbmdsZSBjb25uZWN0aW9uIGFwcHJvYWNoIGZvciBleHRyZW1lbHkgbGltaXRlZCBob3N0aW5nXHJcbmxldCBjb25uZWN0aW9uOiBteXNxbC5Db25uZWN0aW9uIHwgbnVsbCA9IG51bGw7XHJcbmxldCBjb25uZWN0aW9uUHJvbWlzZTogUHJvbWlzZTxteXNxbC5Db25uZWN0aW9uPiB8IG51bGwgPSBudWxsO1xyXG5cclxuY29uc3QgZGJDb25maWcgPSB7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCBcIjE5OC4zOC45MC41MFwiLFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX1BPUlQgfHwgXCIzMzA2XCIpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8IFwiYm9sYWxvb2NfbWF6ZG9vclwiLFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgXCJib2xhbG9vY19tYXoxMjNcIixcclxuICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgXCJFc2JFUjBKZXl0SVhscDQwXCIsXHJcbiAgLy8gT25seSB2YWxpZCBvcHRpb25zIGZvciBteXNxbDIgc2luZ2xlIGNvbm5lY3Rpb25zXHJcbiAgY29ubmVjdFRpbWVvdXQ6IDYwMDAwLFxyXG4gIHRpbWV6b25lOiAnKzAwOjAwJyxcclxufTtcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3Rpb24oKTogUHJvbWlzZTxteXNxbC5Db25uZWN0aW9uPiB7XHJcbiAgLy8gUmV1c2UgZXhpc3RpbmcgY29ubmVjdGlvbiBpZiBhdmFpbGFibGUgYW5kIHN0aWxsIGNvbm5lY3RlZFxyXG4gIGlmIChjb25uZWN0aW9uKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBUZXN0IGlmIGNvbm5lY3Rpb24gaXMgc3RpbGwgYWxpdmUgd2l0aCBhIHNpbXBsZSBxdWVyeVxyXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KCdTRUxFQ1QgMScpO1xyXG4gICAgICByZXR1cm4gY29ubmVjdGlvbjtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIENvbm5lY3Rpb24gaXMgZGVhZCwgY2xlYW4gaXQgdXBcclxuICAgICAgY29uc29sZS5sb2coJ1tEQl0gRXhpc3RpbmcgY29ubmVjdGlvbiBpcyBkZWFkLCBjcmVhdGluZyBuZXcgb25lLi4uJyk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5lbmQoKTtcclxuICAgICAgfSBjYXRjaCAoY2xvc2VFcnJvcikge1xyXG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnMgd2hlbiBjbG9zaW5nIGRlYWQgY29ubmVjdGlvblxyXG4gICAgICB9XHJcbiAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGVyZSdzIGFscmVhZHkgYSBjb25uZWN0aW9uIGJlaW5nIGNyZWF0ZWQsIHdhaXQgZm9yIGl0XHJcbiAgaWYgKGNvbm5lY3Rpb25Qcm9taXNlKSB7XHJcbiAgICByZXR1cm4gY29ubmVjdGlvblByb21pc2U7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZygnW0RCXSBDcmVhdGluZyBuZXcgZGF0YWJhc2UgY29ubmVjdGlvbi4uLicpO1xyXG4gIGNvbm5lY3Rpb25Qcm9taXNlID0gbXlzcWwuY3JlYXRlQ29ubmVjdGlvbihkYkNvbmZpZyk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbm5lY3Rpb24gPSBhd2FpdCBjb25uZWN0aW9uUHJvbWlzZTtcclxuICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ1tEQl0gRGF0YWJhc2UgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIFxyXG4gICAgLy8gSGFuZGxlIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICBjb25uZWN0aW9uLm9uKCdlcnJvcicsIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yOicsIGVycik7XHJcbiAgICAgIGlmIChlcnIuY29kZSA9PT0gJ1BST1RPQ09MX0NPTk5FQ1RJT05fTE9TVCcgfHwgZXJyLmNvZGUgPT09ICdFQ09OTlJFU0VUJykge1xyXG4gICAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBjb25uZWN0aW9uO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbREJdIEZhaWxlZCB0byBjcmVhdGUgZGF0YWJhc2UgY29ubmVjdGlvbjonLCBlcnJvcik7XHJcbiAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeTxUID0gYW55PihcclxuICBzcWw6IHN0cmluZyxcclxuICBwYXJhbXM6IGFueVtdID0gW11cclxuKTogUHJvbWlzZTxUW10+IHtcclxuICBsZXQgcmV0cmllcyA9IDU7IC8vIE1vcmUgcmV0cmllc1xyXG4gIGxldCBkZWxheSA9IDEwMDA7IC8vIFN0YXJ0IHdpdGggc2hvcnRlciBkZWxheVxyXG4gIFxyXG4gIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IHJldHJpZXM7IGF0dGVtcHQrKykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29ubiA9IGF3YWl0IGdldENvbm5lY3Rpb24oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEV4ZWN1dGUgcXVlcnkgd2l0aCB0aW1lb3V0XHJcbiAgICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgY29ubi5xdWVyeShzcWwsIHBhcmFtcyksXHJcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ1F1ZXJ5IHRpbWVvdXQgYWZ0ZXIgMzAgc2Vjb25kcycpKSwgMzAwMDApXHJcbiAgICAgICAgKVxyXG4gICAgICBdKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBLZWVwIGNvbm5lY3Rpb24gYWxpdmUgZm9yIHJldXNlIC0gZG9uJ3QgY2xvc2UgaXRcclxuICAgICAgcmV0dXJuIHJlc3VsdHMgYXMgVFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAvLyBPbmx5IHJlc2V0IGNvbm5lY3Rpb24gc3RhdGUgb24gY29ubmVjdGlvbi1yZWxhdGVkIGVycm9yc1xyXG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BST1RPQ09MX0NPTk5FQ1RJT05fTE9TVCcgfHwgXHJcbiAgICAgICAgICBlcnJvci5jb2RlID09PSAnRUNPTk5SRVNFVCcgfHwgXHJcbiAgICAgICAgICBlcnJvci5jb2RlID09PSAnRVJfVE9PX01BTllfVVNFUl9DT05ORUNUSU9OUycgfHxcclxuICAgICAgICAgIGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCd0aW1lb3V0JykpIHtcclxuICAgICAgICBjb25uZWN0aW9uID0gbnVsbDtcclxuICAgICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYERhdGFiYXNlIHF1ZXJ5IGVycm9yIChhdHRlbXB0ICR7YXR0ZW1wdH0vJHtyZXRyaWVzfSk6YCwge1xyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIGNvZGU6IGVycm9yLmNvZGUsXHJcbiAgICAgICAgc3FsOiBzcWwuc3Vic3RyaW5nKDAsIDEwMCkgKyAoc3FsLmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJycpLFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChhdHRlbXB0ID09PSByZXRyaWVzKSB7XHJcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdFUl9UT09fTUFOWV9VU0VSX0NPTk5FQ1RJT05TJykge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGxpbWl0IHJlYWNoZWQuIFlvdXIgaG9zdGluZyBwcm92aWRlciBoYXMgdmVyeSBzdHJpY3QgY29ubmVjdGlvbiBsaW1pdHMuIFBsZWFzZSB0cnkgYWdhaW4gaW4gYSBmZXcgbW9tZW50cyBvciBjb250YWN0IHlvdXIgaG9zdGluZyBwcm92aWRlciB0byBpbmNyZWFzZSB0aGUgY29ubmVjdGlvbiBsaW1pdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYXRhYmFzZSBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBQcm9ncmVzc2l2ZSBkZWxheSB3aXRoIHNvbWUgcmFuZG9tbmVzcyB0byBhdm9pZCB0aHVuZGVyaW5nIGhlcmRcclxuICAgICAgY29uc3QgcmFuZG9tRGVsYXkgPSBkZWxheSArIE1hdGgucmFuZG9tKCkgKiAxMDAwO1xyXG4gICAgICBjb25zb2xlLmxvZyhgUmV0cnlpbmcgaW4gJHtyYW5kb21EZWxheS50b0ZpeGVkKDApfW1zLi4uYCk7XHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCByYW5kb21EZWxheSkpO1xyXG4gICAgICBkZWxheSAqPSAxLjI7IC8vIFNsb3dlciBncm93dGhcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgdGhyb3cgbmV3IEVycm9yKCdNYXggcmV0cmllcyBleGNlZWRlZCcpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnlPbmU8VCA9IGFueT4oXHJcbiAgc3FsOiBzdHJpbmcsXHJcbiAgcGFyYW1zOiBhbnlbXSA9IFtdXHJcbik6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgcXVlcnk8VD4oc3FsLCBwYXJhbXMpO1xyXG4gIHJldHVybiByZXN1bHRzWzBdIHx8IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0Q29ubmVjdGlvbigpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICB0cnkge1xyXG4gICAgYXdhaXQgcXVlcnkoJ1NFTEVDVCAxIGFzIHRlc3QnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3QgZmFpbGVkOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZUNvbm5lY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgaWYgKGNvbm5lY3Rpb24pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24uZW5kKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBjb25uZWN0aW9uIGNsb3NlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsb3NpbmcgZGF0YWJhc2UgY29ubmVjdGlvbjonLCBlcnJvcik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBjb25uZWN0aW9uID0gbnVsbDtcclxuICAgICAgY29ubmVjdGlvblByb21pc2UgPSBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsibXlzcWwiLCJjb25uZWN0aW9uIiwiY29ubmVjdGlvblByb21pc2UiLCJkYkNvbmZpZyIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiREJfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIkRCX1BPUlQiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJ1c2VyIiwiREJfVVNFUiIsInBhc3N3b3JkIiwiREJfUEFTU1dPUkQiLCJjb25uZWN0VGltZW91dCIsInRpbWV6b25lIiwiZ2V0Q29ubmVjdGlvbiIsInF1ZXJ5IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZW5kIiwiY2xvc2VFcnJvciIsImNyZWF0ZUNvbm5lY3Rpb24iLCJvbiIsImVyciIsImNvZGUiLCJzcWwiLCJwYXJhbXMiLCJyZXRyaWVzIiwiZGVsYXkiLCJhdHRlbXB0IiwiY29ubiIsInJlc3VsdHMiLCJQcm9taXNlIiwicmFjZSIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiRXJyb3IiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJyYW5kb21EZWxheSIsIk1hdGgiLCJyYW5kb20iLCJ0b0ZpeGVkIiwicmVzb2x2ZSIsInF1ZXJ5T25lIiwidGVzdENvbm5lY3Rpb24iLCJjbG9zZUNvbm5lY3Rpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/lib/db-simple.ts\n");

/***/ })

});