"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/lib/db-simple.ts":
/*!******************************!*\
  !*** ./src/lib/db-simple.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeConnection: () => (/* binding */ closeConnection),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(middleware)/./node_modules/mysql2/promise.js\");\n\n// Single connection approach for extremely limited hosting\nlet connection = null;\nlet connectionPromise = null;\nconst dbConfig = {\n    host: process.env.DB_HOST || \"198.38.90.50\",\n    port: parseInt(process.env.DB_PORT || \"3306\"),\n    database: process.env.DB_NAME || \"bolalooc_mazdoor\",\n    user: process.env.DB_USER || \"bolalooc_maz123\",\n    password: process.env.DB_PASSWORD || \"EsbER0JeytIXlp40\",\n    // Only valid options for mysql2 single connections\n    connectTimeout: 60000,\n    timezone: \"+00:00\"\n};\nasync function getConnection() {\n    // Reuse existing connection if available and still connected\n    if (connection) {\n        try {\n            // Test if connection is still alive with a simple query\n            await connection.query(\"SELECT 1\");\n            return connection;\n        } catch (error) {\n            // Connection is dead, clean it up\n            console.log(\"[DB] Existing connection is dead, creating new one...\");\n            try {\n                await connection.end();\n            } catch (closeError) {\n            // Ignore errors when closing dead connection\n            }\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n    // If there's already a connection being created, wait for it\n    if (connectionPromise) {\n        return connectionPromise;\n    }\n    console.log(\"[DB] Creating new database connection...\");\n    connectionPromise = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createConnection(dbConfig);\n    try {\n        connection = await connectionPromise;\n        connectionPromise = null;\n        console.log(\"[DB] Database connection established successfully\");\n        // Handle connection errors\n        connection.on(\"error\", (err)=>{\n            console.error(\"Database connection error:\", err);\n            if (err.code === \"PROTOCOL_CONNECTION_LOST\" || err.code === \"ECONNRESET\") {\n                connection = null;\n                connectionPromise = null;\n            }\n        });\n        return connection;\n    } catch (error) {\n        console.error(\"[DB] Failed to create database connection:\", error);\n        connectionPromise = null;\n        throw error;\n    }\n}\nasync function query(sql, params = []) {\n    let retries = 5; // More retries\n    let delay = 1000; // Start with shorter delay\n    for(let attempt = 1; attempt <= retries; attempt++){\n        let conn = null;\n        try {\n            conn = await getConnection();\n            // Execute query with timeout\n            const [results] = await Promise.race([\n                conn.query(sql, params),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Query timeout after 30 seconds\")), 30000))\n            ]);\n            // Close connection immediately after successful query\n            await conn.end();\n            connection = null;\n            return results;\n        } catch (error) {\n            // Clean up connection on error\n            if (conn) {\n                try {\n                    await conn.end();\n                } catch (closeError) {\n                // Ignore close errors\n                }\n            }\n            connection = null;\n            connectionPromise = null;\n            console.error(`Database query error (attempt ${attempt}/${retries}):`, {\n                error: error.message,\n                code: error.code,\n                sql: sql.substring(0, 100) + (sql.length > 100 ? \"...\" : \"\")\n            });\n            if (attempt === retries) {\n                if (error.code === \"ER_TOO_MANY_USER_CONNECTIONS\") {\n                    throw new Error(\"Database connection limit reached. Your hosting provider has very strict connection limits. Please try again in a few moments or contact your hosting provider to increase the connection limit.\");\n                }\n                throw new Error(`Database error: ${error.message}`);\n            }\n            // Progressive delay with some randomness to avoid thundering herd\n            const randomDelay = delay + Math.random() * 1000;\n            console.log(`Retrying in ${randomDelay.toFixed(0)}ms...`);\n            await new Promise((resolve)=>setTimeout(resolve, randomDelay));\n            delay *= 1.2; // Slower growth\n        }\n    }\n    throw new Error(\"Max retries exceeded\");\n}\nasync function queryOne(sql, params = []) {\n    const results = await query(sql, params);\n    return results[0] || null;\n}\nasync function testConnection() {\n    try {\n        await query(\"SELECT 1 as test\");\n        return true;\n    } catch (error) {\n        console.error(\"Database connection test failed:\", error);\n        return false;\n    }\n}\nasync function closeConnection() {\n    if (connection) {\n        try {\n            await connection.end();\n            console.log(\"Database connection closed successfully\");\n        } catch (error) {\n            console.error(\"Error closing database connection:\", error);\n        } finally{\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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b0I7UUFDdEI7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9saWIvZGItc2ltcGxlLnRzP2U4MDIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gXCJteXNxbDIvcHJvbWlzZVwiO1xyXG5cclxuLy8gU2luZ2xlIGNvbm5lY3Rpb24gYXBwcm9hY2ggZm9yIGV4dHJlbWVseSBsaW1pdGVkIGhvc3RpbmdcclxubGV0IGNvbm5lY3Rpb246IG15c3FsLkNvbm5lY3Rpb24gfCBudWxsID0gbnVsbDtcclxubGV0IGNvbm5lY3Rpb25Qcm9taXNlOiBQcm9taXNlPG15c3FsLkNvbm5lY3Rpb24+IHwgbnVsbCA9IG51bGw7XHJcblxyXG5jb25zdCBkYkNvbmZpZyA9IHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5EQl9IT1NUIHx8IFwiMTk4LjM4LjkwLjUwXCIsXHJcbiAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCBcIjMzMDZcIiksXHJcbiAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LkRCX05BTUUgfHwgXCJib2xhbG9vY19tYXpkb29yXCIsXHJcbiAgdXNlcjogcHJvY2Vzcy5lbnYuREJfVVNFUiB8fCBcImJvbGFsb29jX21hejEyM1wiLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCBcIkVzYkVSMEpleXRJWGxwNDBcIixcclxuICAvLyBPbmx5IHZhbGlkIG9wdGlvbnMgZm9yIG15c3FsMiBzaW5nbGUgY29ubmVjdGlvbnNcclxuICBjb25uZWN0VGltZW91dDogNjAwMDAsXHJcbiAgdGltZXpvbmU6ICcrMDA6MDAnLFxyXG59O1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0Q29ubmVjdGlvbigpOiBQcm9taXNlPG15c3FsLkNvbm5lY3Rpb24+IHtcclxuICAvLyBSZXVzZSBleGlzdGluZyBjb25uZWN0aW9uIGlmIGF2YWlsYWJsZSBhbmQgc3RpbGwgY29ubmVjdGVkXHJcbiAgaWYgKGNvbm5lY3Rpb24pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFRlc3QgaWYgY29ubmVjdGlvbiBpcyBzdGlsbCBhbGl2ZSB3aXRoIGEgc2ltcGxlIHF1ZXJ5XHJcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucXVlcnkoJ1NFTEVDVCAxJyk7XHJcbiAgICAgIHJldHVybiBjb25uZWN0aW9uO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gQ29ubmVjdGlvbiBpcyBkZWFkLCBjbGVhbiBpdCB1cFxyXG4gICAgICBjb25zb2xlLmxvZygnW0RCXSBFeGlzdGluZyBjb25uZWN0aW9uIGlzIGRlYWQsIGNyZWF0aW5nIG5ldyBvbmUuLi4nKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBjb25uZWN0aW9uLmVuZCgpO1xyXG4gICAgICB9IGNhdGNoIChjbG9zZUVycm9yKSB7XHJcbiAgICAgICAgLy8gSWdub3JlIGVycm9ycyB3aGVuIGNsb3NpbmcgZGVhZCBjb25uZWN0aW9uXHJcbiAgICAgIH1cclxuICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIElmIHRoZXJlJ3MgYWxyZWFkeSBhIGNvbm5lY3Rpb24gYmVpbmcgY3JlYXRlZCwgd2FpdCBmb3IgaXRcclxuICBpZiAoY29ubmVjdGlvblByb21pc2UpIHtcclxuICAgIHJldHVybiBjb25uZWN0aW9uUHJvbWlzZTtcclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKCdbREJdIENyZWF0aW5nIG5ldyBkYXRhYmFzZSBjb25uZWN0aW9uLi4uJyk7XHJcbiAgY29ubmVjdGlvblByb21pc2UgPSBteXNxbC5jcmVhdGVDb25uZWN0aW9uKGRiQ29uZmlnKTtcclxuICBcclxuICB0cnkge1xyXG4gICAgY29ubmVjdGlvbiA9IGF3YWl0IGNvbm5lY3Rpb25Qcm9taXNlO1xyXG4gICAgY29ubmVjdGlvblByb21pc2UgPSBudWxsO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnW0RCXSBEYXRhYmFzZSBjb25uZWN0aW9uIGVzdGFibGlzaGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgXHJcbiAgICAvLyBIYW5kbGUgY29ubmVjdGlvbiBlcnJvcnNcclxuICAgIGNvbm5lY3Rpb24ub24oJ2Vycm9yJywgKGVycjogYW55KSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3I6JywgZXJyKTtcclxuICAgICAgaWYgKGVyci5jb2RlID09PSAnUFJPVE9DT0xfQ09OTkVDVElPTl9MT1NUJyB8fCBlcnIuY29kZSA9PT0gJ0VDT05OUkVTRVQnKSB7XHJcbiAgICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgICAgY29ubmVjdGlvblByb21pc2UgPSBudWxsO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tEQl0gRmFpbGVkIHRvIGNyZWF0ZSBkYXRhYmFzZSBjb25uZWN0aW9uOicsIGVycm9yKTtcclxuICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5PFQgPSBhbnk+KFxyXG4gIHNxbDogc3RyaW5nLFxyXG4gIHBhcmFtczogYW55W10gPSBbXVxyXG4pOiBQcm9taXNlPFRbXT4ge1xyXG4gIGxldCByZXRyaWVzID0gNTsgLy8gTW9yZSByZXRyaWVzXHJcbiAgbGV0IGRlbGF5ID0gMTAwMDsgLy8gU3RhcnQgd2l0aCBzaG9ydGVyIGRlbGF5XHJcbiAgXHJcbiAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gcmV0cmllczsgYXR0ZW1wdCsrKSB7XHJcbiAgICBsZXQgY29ubjogbXlzcWwuQ29ubmVjdGlvbiB8IG51bGwgPSBudWxsO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29ubiA9IGF3YWl0IGdldENvbm5lY3Rpb24oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEV4ZWN1dGUgcXVlcnkgd2l0aCB0aW1lb3V0XHJcbiAgICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgY29ubi5xdWVyeShzcWwsIHBhcmFtcyksXHJcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ1F1ZXJ5IHRpbWVvdXQgYWZ0ZXIgMzAgc2Vjb25kcycpKSwgMzAwMDApXHJcbiAgICAgICAgKVxyXG4gICAgICBdKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDbG9zZSBjb25uZWN0aW9uIGltbWVkaWF0ZWx5IGFmdGVyIHN1Y2Nlc3NmdWwgcXVlcnlcclxuICAgICAgYXdhaXQgY29ubi5lbmQoKTtcclxuICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzdWx0cyBhcyBUW107XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIC8vIENsZWFuIHVwIGNvbm5lY3Rpb24gb24gZXJyb3JcclxuICAgICAgaWYgKGNvbm4pIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgY29ubi5lbmQoKTtcclxuICAgICAgICB9IGNhdGNoIChjbG9zZUVycm9yKSB7XHJcbiAgICAgICAgICAvLyBJZ25vcmUgY2xvc2UgZXJyb3JzXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmVycm9yKGBEYXRhYmFzZSBxdWVyeSBlcnJvciAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7cmV0cmllc30pOmAsIHtcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBjb2RlOiBlcnJvci5jb2RlLFxyXG4gICAgICAgIHNxbDogc3FsLnN1YnN0cmluZygwLCAxMDApICsgKHNxbC5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnKSxcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXR0ZW1wdCA9PT0gcmV0cmllcykge1xyXG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSAnRVJfVE9PX01BTllfVVNFUl9DT05ORUNUSU9OUycpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBsaW1pdCByZWFjaGVkLiBZb3VyIGhvc3RpbmcgcHJvdmlkZXIgaGFzIHZlcnkgc3RyaWN0IGNvbm5lY3Rpb24gbGltaXRzLiBQbGVhc2UgdHJ5IGFnYWluIGluIGEgZmV3IG1vbWVudHMgb3IgY29udGFjdCB5b3VyIGhvc3RpbmcgcHJvdmlkZXIgdG8gaW5jcmVhc2UgdGhlIGNvbm5lY3Rpb24gbGltaXQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRGF0YWJhc2UgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gUHJvZ3Jlc3NpdmUgZGVsYXkgd2l0aCBzb21lIHJhbmRvbW5lc3MgdG8gYXZvaWQgdGh1bmRlcmluZyBoZXJkXHJcbiAgICAgIGNvbnN0IHJhbmRvbURlbGF5ID0gZGVsYXkgKyBNYXRoLnJhbmRvbSgpICogMTAwMDtcclxuICAgICAgY29uc29sZS5sb2coYFJldHJ5aW5nIGluICR7cmFuZG9tRGVsYXkudG9GaXhlZCgwKX1tcy4uLmApO1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgcmFuZG9tRGVsYXkpKTtcclxuICAgICAgZGVsYXkgKj0gMS4yOyAvLyBTbG93ZXIgZ3Jvd3RoXHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHRocm93IG5ldyBFcnJvcignTWF4IHJldHJpZXMgZXhjZWVkZWQnKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5T25lPFQgPSBhbnk+KFxyXG4gIHNxbDogc3RyaW5nLFxyXG4gIHBhcmFtczogYW55W10gPSBbXVxyXG4pOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5PFQ+KHNxbCwgcGFyYW1zKTtcclxuICByZXR1cm4gcmVzdWx0c1swXSB8fCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHF1ZXJ5KCdTRUxFQ1QgMSBhcyB0ZXN0Jyk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiB0ZXN0IGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xvc2VDb25uZWN0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChjb25uZWN0aW9uKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLmVuZCgpO1xyXG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbG9zaW5nIGRhdGFiYXNlIGNvbm5lY3Rpb246JywgZXJyb3IpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIm15c3FsIiwiY29ubmVjdGlvbiIsImNvbm5lY3Rpb25Qcm9taXNlIiwiZGJDb25maWciLCJob3N0IiwicHJvY2VzcyIsImVudiIsIkRCX0hPU1QiLCJwb3J0IiwicGFyc2VJbnQiLCJEQl9QT1JUIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwidXNlciIsIkRCX1VTRVIiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwiY29ubmVjdFRpbWVvdXQiLCJ0aW1lem9uZSIsImdldENvbm5lY3Rpb24iLCJxdWVyeSIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImVuZCIsImNsb3NlRXJyb3IiLCJjcmVhdGVDb25uZWN0aW9uIiwib24iLCJlcnIiLCJjb2RlIiwic3FsIiwicGFyYW1zIiwicmV0cmllcyIsImRlbGF5IiwiYXR0ZW1wdCIsImNvbm4iLCJyZXN1bHRzIiwiUHJvbWlzZSIsInJhY2UiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsIkVycm9yIiwibWVzc2FnZSIsInN1YnN0cmluZyIsImxlbmd0aCIsInJhbmRvbURlbGF5IiwiTWF0aCIsInJhbmRvbSIsInRvRml4ZWQiLCJyZXNvbHZlIiwicXVlcnlPbmUiLCJ0ZXN0Q29ubmVjdGlvbiIsImNsb3NlQ29ubmVjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/lib/db-simple.ts\n");

/***/ })

});