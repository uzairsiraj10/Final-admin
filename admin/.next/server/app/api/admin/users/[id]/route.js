/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/users/[id]/route";
exports.ids = ["app/api/admin/users/[id]/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:events");

/***/ }),

/***/ "node:http":
/*!****************************!*\
  !*** external "node:http" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:http");

/***/ }),

/***/ "node:https":
/*!*****************************!*\
  !*** external "node:https" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:https");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:util");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&page=%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&page=%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_mazdoor_admin_src_app_api_admin_users_id_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/admin/users/[id]/route.ts */ \"(rsc)/./src/app/api/admin/users/[id]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/users/[id]/route\",\n        pathname: \"/api/admin/users/[id]\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/users/[id]/route\"\n    },\n    resolvedPagePath: \"E:\\\\mazdoor\\\\admin\\\\src\\\\app\\\\api\\\\admin\\\\users\\\\[id]\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_mazdoor_admin_src_app_api_admin_users_id_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/admin/users/[id]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRnVzZXJzJTJGJTVCaWQlNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFkbWluJTJGdXNlcnMlMkYlNUJpZCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFkbWluJTJGdXNlcnMlMkYlNUJpZCU1RCUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDbWF6ZG9vciU1Q2FkbWluJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1FJTNBJTVDbWF6ZG9vciU1Q2FkbWluJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ2U7QUFDNUY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbi1wYW5lbC8/MGM5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJFOlxcXFxtYXpkb29yXFxcXGFkbWluXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFkbWluXFxcXHVzZXJzXFxcXFtpZF1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FkbWluL3VzZXJzL1tpZF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hZG1pbi91c2Vycy9baWRdXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hZG1pbi91c2Vycy9baWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRTpcXFxcbWF6ZG9vclxcXFxhZG1pblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhZG1pblxcXFx1c2Vyc1xcXFxbaWRdXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FkbWluL3VzZXJzL1tpZF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&page=%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/admin/users/[id]/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/admin/users/[id]/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\n\n// GET: Get user by ID\nasync function GET(request, { params }) {\n    try {\n        const { id } = params;\n        const users = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id, name, email, role, status, created_at, updated_at FROM users WHERE id = ?\", [\n            id\n        ]);\n        if (users.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(users[0]);\n    } catch (error) {\n        console.error(\"User fetch error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch user\"\n        }, {\n            status: 500\n        });\n    }\n}\n// PUT: Update user\nasync function PUT(request, { params }) {\n    try {\n        const { id } = params;\n        const { name, email, password, role, status } = await request.json();\n        // Check if user exists\n        const existingUser = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id FROM users WHERE id = ?\", [\n            id\n        ]);\n        if (existingUser.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Check if email is already taken by another user\n        if (email) {\n            const emailCheck = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id FROM users WHERE email = ? AND id != ?\", [\n                email,\n                id\n            ]);\n            if (emailCheck.length > 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Email already taken by another user\"\n                }, {\n                    status: 400\n                });\n            }\n        }\n        // Build update query\n        let updateQuery = \"UPDATE users SET \";\n        const updateValues = [];\n        const updateFields = [];\n        if (name) {\n            updateFields.push(\"name = ?\");\n            updateValues.push(name);\n        }\n        if (email) {\n            updateFields.push(\"email = ?\");\n            updateValues.push(email);\n        }\n        if (password) {\n            updateFields.push(\"password_hash = ?\");\n            updateValues.push(await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.hashPassword)(password));\n        }\n        if (role) {\n            updateFields.push(\"role = ?\");\n            updateValues.push(role);\n        }\n        if (status) {\n            updateFields.push(\"status = ?\");\n            updateValues.push(status);\n        }\n        updateFields.push(\"updated_at = CURRENT_TIMESTAMP\");\n        updateQuery += updateFields.join(\", \") + \" WHERE id = ?\";\n        updateValues.push(id);\n        await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(updateQuery, updateValues);\n        const updatedUser = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id, name, email, role, status, created_at, updated_at FROM users WHERE id = ?\", [\n            id\n        ]);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(updatedUser[0]);\n    } catch (error) {\n        console.error(\"User update error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to update user\"\n        }, {\n            status: 500\n        });\n    }\n}\n// DELETE: Delete user\nasync function DELETE(request, { params }) {\n    try {\n        const { id } = params;\n        // Check if user exists\n        const existingUser = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id FROM users WHERE id = ?\", [\n            id\n        ]);\n        if (existingUser.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"User not found\"\n            }, {\n                status: 404\n            });\n        }\n        // Delete user\n        await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"DELETE FROM users WHERE id = ?\", [\n            id\n        ]);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"User deleted successfully\"\n        });\n    } catch (error) {\n        console.error(\"User deletion error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to delete user\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZG1pbi91c2Vycy9baWRdL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF3RDtBQUN2QjtBQUNTO0FBRTFDLHNCQUFzQjtBQUNmLGVBQWVHLElBQ3BCQyxPQUFvQixFQUNwQixFQUFFQyxNQUFNLEVBQThCO0lBRXRDLElBQUk7UUFDRixNQUFNLEVBQUVDLEVBQUUsRUFBRSxHQUFHRDtRQUNmLE1BQU1FLFFBQVEsTUFBTU4sOENBQUtBLENBQ3ZCLHdGQUNBO1lBQUNLO1NBQUc7UUFHTixJQUFJQyxNQUFNQyxNQUFNLEtBQUssR0FBRztZQUN0QixPQUFPUixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFpQixHQUMxQjtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsT0FBT1gscURBQVlBLENBQUNTLElBQUksQ0FBQ0YsS0FBSyxDQUFDLEVBQUU7SUFDbkMsRUFBRSxPQUFPRyxPQUFPO1FBQ2RFLFFBQVFGLEtBQUssQ0FBQyxxQkFBcUJBO1FBQ25DLE9BQU9WLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO1lBQUVDLE9BQU87UUFBdUIsR0FDaEM7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0Y7QUFFQSxtQkFBbUI7QUFDWixlQUFlRSxJQUNwQlQsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUE4QjtJQUV0QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBR0Q7UUFDZixNQUFNLEVBQUVTLElBQUksRUFBRUMsS0FBSyxFQUFFQyxRQUFRLEVBQUVDLElBQUksRUFBRU4sTUFBTSxFQUFFLEdBQUcsTUFBTVAsUUFBUUssSUFBSTtRQUVsRSx1QkFBdUI7UUFDdkIsTUFBTVMsZUFBZSxNQUFNakIsOENBQUtBLENBQUMscUNBQXFDO1lBQUNLO1NBQUc7UUFDMUUsSUFBSVksYUFBYVYsTUFBTSxLQUFLLEdBQUc7WUFDN0IsT0FBT1IscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBaUIsR0FDMUI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGtEQUFrRDtRQUNsRCxJQUFJSSxPQUFPO1lBQ1QsTUFBTUksYUFBYSxNQUFNbEIsOENBQUtBLENBQzVCLG9EQUNBO2dCQUFDYztnQkFBT1Q7YUFBRztZQUViLElBQUlhLFdBQVdYLE1BQU0sR0FBRyxHQUFHO2dCQUN6QixPQUFPUixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtvQkFBRUMsT0FBTztnQkFBc0MsR0FDL0M7b0JBQUVDLFFBQVE7Z0JBQUk7WUFFbEI7UUFDRjtRQUVBLHFCQUFxQjtRQUNyQixJQUFJUyxjQUFjO1FBQ2xCLE1BQU1DLGVBQWUsRUFBRTtRQUN2QixNQUFNQyxlQUFlLEVBQUU7UUFFdkIsSUFBSVIsTUFBTTtZQUNSUSxhQUFhQyxJQUFJLENBQUM7WUFDbEJGLGFBQWFFLElBQUksQ0FBQ1Q7UUFDcEI7UUFDQSxJQUFJQyxPQUFPO1lBQ1RPLGFBQWFDLElBQUksQ0FBQztZQUNsQkYsYUFBYUUsSUFBSSxDQUFDUjtRQUNwQjtRQUNBLElBQUlDLFVBQVU7WUFDWk0sYUFBYUMsSUFBSSxDQUFDO1lBQ2xCRixhQUFhRSxJQUFJLENBQUMsTUFBTXJCLHVEQUFZQSxDQUFDYztRQUN2QztRQUNBLElBQUlDLE1BQU07WUFDUkssYUFBYUMsSUFBSSxDQUFDO1lBQ2xCRixhQUFhRSxJQUFJLENBQUNOO1FBQ3BCO1FBQ0EsSUFBSU4sUUFBUTtZQUNWVyxhQUFhQyxJQUFJLENBQUM7WUFDbEJGLGFBQWFFLElBQUksQ0FBQ1o7UUFDcEI7UUFFQVcsYUFBYUMsSUFBSSxDQUFDO1FBQ2xCSCxlQUFlRSxhQUFhRSxJQUFJLENBQUMsUUFBUTtRQUN6Q0gsYUFBYUUsSUFBSSxDQUFDakI7UUFFbEIsTUFBTUwsOENBQUtBLENBQUNtQixhQUFhQztRQUV6QixNQUFNSSxjQUFjLE1BQU14Qiw4Q0FBS0EsQ0FDN0Isd0ZBQ0E7WUFBQ0s7U0FBRztRQUdOLE9BQU9OLHFEQUFZQSxDQUFDUyxJQUFJLENBQUNnQixXQUFXLENBQUMsRUFBRTtJQUN6QyxFQUFFLE9BQU9mLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLHNCQUFzQkE7UUFDcEMsT0FBT1YscURBQVlBLENBQUNTLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUF3QixHQUNqQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLHNCQUFzQjtBQUNmLGVBQWVlLE9BQ3BCdEIsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUE4QjtJQUV0QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBR0Q7UUFFZix1QkFBdUI7UUFDdkIsTUFBTWEsZUFBZSxNQUFNakIsOENBQUtBLENBQUMscUNBQXFDO1lBQUNLO1NBQUc7UUFDMUUsSUFBSVksYUFBYVYsTUFBTSxLQUFLLEdBQUc7WUFDN0IsT0FBT1IscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBaUIsR0FDMUI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGNBQWM7UUFDZCxNQUFNViw4Q0FBS0EsQ0FBQyxrQ0FBa0M7WUFBQ0s7U0FBRztRQUVsRCxPQUFPTixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQUVrQixTQUFTO1FBQTRCO0lBQ2xFLEVBQUUsT0FBT2pCLE9BQU87UUFDZEUsUUFBUUYsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsT0FBT1YscURBQVlBLENBQUNTLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUF3QixHQUNqQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FkbWluLXBhbmVsLy4vc3JjL2FwcC9hcGkvYWRtaW4vdXNlcnMvW2lkXS9yb3V0ZS50cz9jOTRhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgcXVlcnkgfSBmcm9tIFwiQC9saWIvZGJcIjtcclxuaW1wb3J0IHsgaGFzaFBhc3N3b3JkIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcclxuXHJcbi8vIEdFVDogR2V0IHVzZXIgYnkgSURcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChcclxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcclxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcGFyYW1zO1xyXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBxdWVyeShcclxuICAgICAgXCJTRUxFQ1QgaWQsIG5hbWUsIGVtYWlsLCByb2xlLCBzdGF0dXMsIGNyZWF0ZWRfYXQsIHVwZGF0ZWRfYXQgRlJPTSB1c2VycyBXSEVSRSBpZCA9ID9cIixcclxuICAgICAgW2lkXVxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAodXNlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiBcIlVzZXIgbm90IGZvdW5kXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDA0IH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24odXNlcnNbMF0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiVXNlciBmZXRjaCBlcnJvcjpcIiwgZXJyb3IpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiBcIkZhaWxlZCB0byBmZXRjaCB1c2VyXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gUFVUOiBVcGRhdGUgdXNlclxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUFVUKFxyXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGlkIH0gPSBwYXJhbXM7XHJcbiAgICBjb25zdCB7IG5hbWUsIGVtYWlsLCBwYXNzd29yZCwgcm9sZSwgc3RhdHVzIH0gPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuXHJcbiAgICAvLyBDaGVjayBpZiB1c2VyIGV4aXN0c1xyXG4gICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgcXVlcnkoXCJTRUxFQ1QgaWQgRlJPTSB1c2VycyBXSEVSRSBpZCA9ID9cIiwgW2lkXSk7XHJcbiAgICBpZiAoZXhpc3RpbmdVc2VyLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogXCJVc2VyIG5vdCBmb3VuZFwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgZW1haWwgaXMgYWxyZWFkeSB0YWtlbiBieSBhbm90aGVyIHVzZXJcclxuICAgIGlmIChlbWFpbCkge1xyXG4gICAgICBjb25zdCBlbWFpbENoZWNrID0gYXdhaXQgcXVlcnkoXHJcbiAgICAgICAgXCJTRUxFQ1QgaWQgRlJPTSB1c2VycyBXSEVSRSBlbWFpbCA9ID8gQU5EIGlkICE9ID9cIixcclxuICAgICAgICBbZW1haWwsIGlkXVxyXG4gICAgICApO1xyXG4gICAgICBpZiAoZW1haWxDaGVjay5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogXCJFbWFpbCBhbHJlYWR5IHRha2VuIGJ5IGFub3RoZXIgdXNlclwiIH0sXHJcbiAgICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQnVpbGQgdXBkYXRlIHF1ZXJ5XHJcbiAgICBsZXQgdXBkYXRlUXVlcnkgPSBcIlVQREFURSB1c2VycyBTRVQgXCI7XHJcbiAgICBjb25zdCB1cGRhdGVWYWx1ZXMgPSBbXTtcclxuICAgIGNvbnN0IHVwZGF0ZUZpZWxkcyA9IFtdO1xyXG5cclxuICAgIGlmIChuYW1lKSB7XHJcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKFwibmFtZSA9ID9cIik7XHJcbiAgICAgIHVwZGF0ZVZhbHVlcy5wdXNoKG5hbWUpO1xyXG4gICAgfVxyXG4gICAgaWYgKGVtYWlsKSB7XHJcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKFwiZW1haWwgPSA/XCIpO1xyXG4gICAgICB1cGRhdGVWYWx1ZXMucHVzaChlbWFpbCk7XHJcbiAgICB9XHJcbiAgICBpZiAocGFzc3dvcmQpIHtcclxuICAgICAgdXBkYXRlRmllbGRzLnB1c2goXCJwYXNzd29yZF9oYXNoID0gP1wiKTtcclxuICAgICAgdXBkYXRlVmFsdWVzLnB1c2goYXdhaXQgaGFzaFBhc3N3b3JkKHBhc3N3b3JkKSk7XHJcbiAgICB9XHJcbiAgICBpZiAocm9sZSkge1xyXG4gICAgICB1cGRhdGVGaWVsZHMucHVzaChcInJvbGUgPSA/XCIpO1xyXG4gICAgICB1cGRhdGVWYWx1ZXMucHVzaChyb2xlKTtcclxuICAgIH1cclxuICAgIGlmIChzdGF0dXMpIHtcclxuICAgICAgdXBkYXRlRmllbGRzLnB1c2goXCJzdGF0dXMgPSA/XCIpO1xyXG4gICAgICB1cGRhdGVWYWx1ZXMucHVzaChzdGF0dXMpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUZpZWxkcy5wdXNoKFwidXBkYXRlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QXCIpO1xyXG4gICAgdXBkYXRlUXVlcnkgKz0gdXBkYXRlRmllbGRzLmpvaW4oXCIsIFwiKSArIFwiIFdIRVJFIGlkID0gP1wiO1xyXG4gICAgdXBkYXRlVmFsdWVzLnB1c2goaWQpO1xyXG5cclxuICAgIGF3YWl0IHF1ZXJ5KHVwZGF0ZVF1ZXJ5LCB1cGRhdGVWYWx1ZXMpO1xyXG5cclxuICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0gYXdhaXQgcXVlcnkoXHJcbiAgICAgIFwiU0VMRUNUIGlkLCBuYW1lLCBlbWFpbCwgcm9sZSwgc3RhdHVzLCBjcmVhdGVkX2F0LCB1cGRhdGVkX2F0IEZST00gdXNlcnMgV0hFUkUgaWQgPSA/XCIsXHJcbiAgICAgIFtpZF1cclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHVwZGF0ZWRVc2VyWzBdKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIlVzZXIgdXBkYXRlIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6IFwiRmFpbGVkIHRvIHVwZGF0ZSB1c2VyXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gREVMRVRFOiBEZWxldGUgdXNlclxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gREVMRVRFKFxyXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxyXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGlkIH0gPSBwYXJhbXM7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgdXNlciBleGlzdHNcclxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHF1ZXJ5KFwiU0VMRUNUIGlkIEZST00gdXNlcnMgV0hFUkUgaWQgPSA/XCIsIFtpZF0pO1xyXG4gICAgaWYgKGV4aXN0aW5nVXNlci5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwiVXNlciBub3QgZm91bmRcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIERlbGV0ZSB1c2VyXHJcbiAgICBhd2FpdCBxdWVyeShcIkRFTEVURSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gP1wiLCBbaWRdKTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIiB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIlVzZXIgZGVsZXRpb24gZXJyb3I6XCIsIGVycm9yKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogXCJGYWlsZWQgdG8gZGVsZXRlIHVzZXJcIiB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJxdWVyeSIsImhhc2hQYXNzd29yZCIsIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJpZCIsInVzZXJzIiwibGVuZ3RoIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiY29uc29sZSIsIlBVVCIsIm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwicm9sZSIsImV4aXN0aW5nVXNlciIsImVtYWlsQ2hlY2siLCJ1cGRhdGVRdWVyeSIsInVwZGF0ZVZhbHVlcyIsInVwZGF0ZUZpZWxkcyIsInB1c2giLCJqb2luIiwidXBkYXRlZFVzZXIiLCJERUxFVEUiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/admin/users/[id]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   login: () => (/* binding */ login),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   verifyJWT: () => (/* binding */ verifyJWT),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db */ \"(rsc)/./src/lib/db.ts\");\n\n\n\n\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key\");\nfunction hashPassword(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, 10);\n}\nfunction verifyPassword(password, hashedPassword) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(password, hashedPassword);\n}\nasync function signJWT(payload, options = {\n    exp: \"7d\"\n}) {\n    try {\n        const token = await new jose__WEBPACK_IMPORTED_MODULE_0__.SignJWT({\n            ...payload\n        }).setProtectedHeader({\n            alg: \"HS256\"\n        }).setIssuedAt().setExpirationTime(options.exp).sign(JWT_SECRET);\n        return token;\n    } catch (error) {\n        console.error(\"JWT signing error:\", error);\n        throw error;\n    }\n}\nasync function verifyJWT(token) {\n    try {\n        const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_0__.jwtVerify)(token, JWT_SECRET);\n        return verified.payload;\n    } catch (error) {\n        console.error(\"JWT verification error:\", error);\n        throw error;\n    }\n}\nasync function getSession(req) {\n    const token = req.cookies.get(\"token\")?.value;\n    if (!token) return null;\n    try {\n        const verified = await verifyJWT(token);\n        return verified;\n    } catch  {\n        return null;\n    }\n}\nasync function getCurrentUser() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    const token = cookieStore.get(\"token\")?.value;\n    if (!token) return null;\n    try {\n        const verified = await verifyJWT(token);\n        const user = await (0,_db__WEBPACK_IMPORTED_MODULE_3__.queryOne)(\"SELECT id, email, name, role FROM users WHERE id = ?\", [\n            parseInt(verified.sub, 10)\n        ]);\n        return user;\n    } catch  {\n        return null;\n    }\n}\nasync function login(email, password) {\n    console.log(\"[AUTH] Starting login process...\");\n    console.log(\"[AUTH] Provided email:\", email);\n    const user = await (0,_db__WEBPACK_IMPORTED_MODULE_3__.queryOne)(\"SELECT id, email, name, role, password_hash FROM users WHERE email = ?\", [\n        email\n    ]);\n    console.log(\"[AUTH] DB query result:\", user);\n    if (!user) {\n        console.warn(\"[AUTH] No user found with that email.\");\n        throw new Error(\"Invalid credentials\");\n    }\n    console.log(\"[AUTH] Stored hash:\", user.password_hash);\n    const isValid = await verifyPassword(password, user.password_hash);\n    console.log(\"[AUTH] Password match:\", isValid);\n    if (!isValid) {\n        console.warn(\"[AUTH] Password did not match.\");\n        throw new Error(\"Invalid credentials\");\n    }\n    const token = await signJWT({\n        sub: user.id.toString(),\n        email: user.email,\n        role: user.role\n    });\n    console.log(\"[AUTH] JWT created:\", token);\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.set(\"token\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        expires: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n    });\n    console.log(\"[AUTH] Token cookie set.\");\n    return {\n        token,\n        user: {\n            id: user.id,\n            email: user.email,\n            name: user.name,\n            role: user.role\n        }\n    };\n}\nasync function logout() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.delete(\"token\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVFjLEdBQUcsQ0FBQyx1QkFBdUJyQjtJQUVuQyxNQUFNZSxjQUFjaEMscURBQU9BO0lBQzNCZ0MsWUFBWWMsR0FBRyxDQUFDLFNBQVM3QixPQUFPO1FBQzlCOEIsVUFBVTtRQUNWQyxRQUFRM0Msa0JBQXlCO1FBQ2pDNEMsVUFBVTtRQUNWQyxTQUFTLElBQUlDLEtBQUtBLEtBQUtDLEdBQUcsS0FBSyxJQUFJLEtBQUssS0FBSyxLQUFLO0lBQ3BEO0lBRUE1QixRQUFRYyxHQUFHLENBQUM7SUFFWixPQUFPO1FBQ0xyQjtRQUNBZ0IsTUFBTTtZQUNKVSxJQUFJVixLQUFLVSxFQUFFO1lBQ1hOLE9BQU9KLEtBQUtJLEtBQUs7WUFDakJnQixNQUFNcEIsS0FBS29CLElBQUk7WUFDZlIsTUFBTVosS0FBS1ksSUFBSTtRQUNqQjtJQUNGO0FBQ0Y7QUFFTyxlQUFlUztJQUNwQixNQUFNdEIsY0FBY2hDLHFEQUFPQTtJQUMzQmdDLFlBQVl1QixNQUFNLENBQUM7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbi1wYW5lbC8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNpZ25KV1QsIGp3dFZlcmlmeSB9IGZyb20gXCJqb3NlXCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XHJcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XHJcbmltcG9ydCB7IHR5cGUgTmV4dFJlcXVlc3QgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgcXVlcnlPbmUgfSBmcm9tIFwiLi9kYlwiO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShcclxuICBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8IFwieW91ci1zZWNyZXQta2V5XCJcclxuKTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XHJcbiAgaWQ6IG51bWJlcjtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICByb2xlOiBcImFkbWluXCIgfCBcInN0YWZmXCI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZChcclxuICBwYXNzd29yZDogc3RyaW5nLFxyXG4gIGhhc2hlZFBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSldUKFxyXG4gIHBheWxvYWQ6IHsgc3ViOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmc7IHJvbGU6IHN0cmluZyB9LFxyXG4gIG9wdGlvbnM6IHsgZXhwOiBzdHJpbmcgfSA9IHsgZXhwOiBcIjdkXCIgfVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBuZXcgU2lnbkpXVCh7IC4uLnBheWxvYWQgfSlcclxuICAgICAgLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogXCJIUzI1NlwiIH0pXHJcbiAgICAgIC5zZXRJc3N1ZWRBdCgpXHJcbiAgICAgIC5zZXRFeHBpcmF0aW9uVGltZShvcHRpb25zLmV4cClcclxuICAgICAgLnNpZ24oSldUX1NFQ1JFVCk7XHJcblxyXG4gICAgcmV0dXJuIHRva2VuO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiSldUIHNpZ25pbmcgZXJyb3I6XCIsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUpXVDxUPih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxUPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKTtcclxuICAgIHJldHVybiB2ZXJpZmllZC5wYXlsb2FkIGFzIFQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJKV1QgdmVyaWZpY2F0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICBjb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmdldChcInRva2VuXCIpPy52YWx1ZTtcclxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5SldUPHtcclxuICAgICAgc3ViOiBzdHJpbmc7XHJcbiAgICAgIGVtYWlsOiBzdHJpbmc7XHJcbiAgICAgIHJvbGU6IHN0cmluZztcclxuICAgIH0+KHRva2VuKTtcclxuICAgIHJldHVybiB2ZXJpZmllZDtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldChcInRva2VuXCIpPy52YWx1ZTtcclxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5SldUPHtcclxuICAgICAgc3ViOiBzdHJpbmc7XHJcbiAgICAgIGVtYWlsOiBzdHJpbmc7XHJcbiAgICAgIHJvbGU6IHN0cmluZztcclxuICAgIH0+KHRva2VuKTtcclxuXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcXVlcnlPbmU8VXNlcj4oXHJcbiAgICAgIFwiU0VMRUNUIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gP1wiLFxyXG4gICAgICBbcGFyc2VJbnQodmVyaWZpZWQuc3ViLCAxMCldXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB1c2VyO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9naW4oZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIFN0YXJ0aW5nIGxvZ2luIHByb2Nlc3MuLi5cIik7XHJcbiAgY29uc29sZS5sb2coXCJbQVVUSF0gUHJvdmlkZWQgZW1haWw6XCIsIGVtYWlsKTtcclxuXHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IHF1ZXJ5T25lPFVzZXIgJiB7IHBhc3N3b3JkX2hhc2g6IHN0cmluZyB9PihcclxuICAgIFwiU0VMRUNUIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSwgcGFzc3dvcmRfaGFzaCBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gP1wiLFxyXG4gICAgW2VtYWlsXVxyXG4gICk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIERCIHF1ZXJ5IHJlc3VsdDpcIiwgdXNlcik7XHJcblxyXG4gIGlmICghdXNlcikge1xyXG4gICAgY29uc29sZS53YXJuKFwiW0FVVEhdIE5vIHVzZXIgZm91bmQgd2l0aCB0aGF0IGVtYWlsLlwiKTtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY3JlZGVudGlhbHNcIik7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZyhcIltBVVRIXSBTdG9yZWQgaGFzaDpcIiwgdXNlci5wYXNzd29yZF9oYXNoKTtcclxuXHJcbiAgY29uc3QgaXNWYWxpZCA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkX2hhc2gpO1xyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIFBhc3N3b3JkIG1hdGNoOlwiLCBpc1ZhbGlkKTtcclxuXHJcbiAgaWYgKCFpc1ZhbGlkKSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJbQVVUSF0gUGFzc3dvcmQgZGlkIG5vdCBtYXRjaC5cIik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNyZWRlbnRpYWxzXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBzaWduSldUKHtcclxuICAgIHN1YjogdXNlci5pZC50b1N0cmluZygpLFxyXG4gICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIEpXVCBjcmVhdGVkOlwiLCB0b2tlbik7XHJcblxyXG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpO1xyXG4gIGNvb2tpZVN0b3JlLnNldChcInRva2VuXCIsIHRva2VuLCB7XHJcbiAgICBodHRwT25seTogdHJ1ZSxcclxuICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiLFxyXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXHJcbiAgICBleHBpcmVzOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyA3IGRheXNcclxuICB9KTtcclxuXHJcbiAgY29uc29sZS5sb2coXCJbQVVUSF0gVG9rZW4gY29va2llIHNldC5cIik7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB0b2tlbixcclxuICAgIHVzZXI6IHtcclxuICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICBuYW1lOiB1c2VyLm5hbWUsXHJcbiAgICAgIHJvbGU6IHVzZXIucm9sZSxcclxuICAgIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ291dCgpIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBjb29raWVTdG9yZS5kZWxldGUoXCJ0b2tlblwiKTtcclxufVxyXG4iXSwibmFtZXMiOlsiU2lnbkpXVCIsImp3dFZlcmlmeSIsImJjcnlwdCIsImNvb2tpZXMiLCJxdWVyeU9uZSIsIkpXVF9TRUNSRVQiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsInByb2Nlc3MiLCJlbnYiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImhhc2giLCJ2ZXJpZnlQYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwiY29tcGFyZSIsInNpZ25KV1QiLCJwYXlsb2FkIiwib3B0aW9ucyIsImV4cCIsInRva2VuIiwic2V0UHJvdGVjdGVkSGVhZGVyIiwiYWxnIiwic2V0SXNzdWVkQXQiLCJzZXRFeHBpcmF0aW9uVGltZSIsInNpZ24iLCJlcnJvciIsImNvbnNvbGUiLCJ2ZXJpZnlKV1QiLCJ2ZXJpZmllZCIsImdldFNlc3Npb24iLCJyZXEiLCJnZXQiLCJ2YWx1ZSIsImdldEN1cnJlbnRVc2VyIiwiY29va2llU3RvcmUiLCJ1c2VyIiwicGFyc2VJbnQiLCJzdWIiLCJsb2dpbiIsImVtYWlsIiwibG9nIiwid2FybiIsIkVycm9yIiwicGFzc3dvcmRfaGFzaCIsImlzVmFsaWQiLCJpZCIsInRvU3RyaW5nIiwicm9sZSIsInNldCIsImh0dHBPbmx5Iiwic2VjdXJlIiwic2FtZVNpdGUiLCJleHBpcmVzIiwiRGF0ZSIsIm5vdyIsIm5hbWUiLCJsb2dvdXQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db-simple.ts":
/*!******************************!*\
  !*** ./src/lib/db-simple.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeConnection: () => (/* binding */ closeConnection),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n\n// Single connection approach for extremely limited hosting\nlet connection = null;\nlet connectionPromise = null;\nconst dbConfig = {\n    host: process.env.DB_HOST || \"198.38.90.50\",\n    port: parseInt(process.env.DB_PORT || \"3306\"),\n    database: process.env.DB_NAME || \"bolalooc_mazdoor\",\n    user: process.env.DB_USER || \"bolalooc_maz123\",\n    password: process.env.DB_PASSWORD || \"EsbER0JeytIXlp40\",\n    // Only valid options for mysql2 single connections\n    connectTimeout: 60000,\n    timezone: \"+00:00\"\n};\nasync function getConnection() {\n    // Reuse existing connection if available and still connected\n    if (connection) {\n        try {\n            // Test if connection is still alive with a simple query\n            await connection.query(\"SELECT 1\");\n            return connection;\n        } catch (error) {\n            // Connection is dead, clean it up\n            console.log(\"[DB] Existing connection is dead, creating new one...\");\n            try {\n                await connection.end();\n            } catch (closeError) {\n            // Ignore errors when closing dead connection\n            }\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n    // If there's already a connection being created, wait for it\n    if (connectionPromise) {\n        return connectionPromise;\n    }\n    console.log(\"[DB] Creating new database connection...\");\n    connectionPromise = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createConnection(dbConfig);\n    try {\n        connection = await connectionPromise;\n        connectionPromise = null;\n        console.log(\"[DB] Database connection established successfully\");\n        // Handle connection errors\n        connection.on(\"error\", (err)=>{\n            console.error(\"Database connection error:\", err);\n            if (err.code === \"PROTOCOL_CONNECTION_LOST\" || err.code === \"ECONNRESET\") {\n                connection = null;\n                connectionPromise = null;\n            }\n        });\n        return connection;\n    } catch (error) {\n        console.error(\"[DB] Failed to create database connection:\", error);\n        connectionPromise = null;\n        throw error;\n    }\n}\nasync function query(sql, params = []) {\n    let retries = 5; // More retries\n    let delay = 1000; // Start with shorter delay\n    for(let attempt = 1; attempt <= retries; attempt++){\n        try {\n            const conn = await getConnection();\n            // Execute query with timeout\n            const [results] = await Promise.race([\n                conn.query(sql, params),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Query timeout after 30 seconds\")), 30000))\n            ]);\n            // Keep connection alive for reuse - don't close it\n            return results;\n        } catch (error) {\n            // Only reset connection state on connection-related errors\n            if (error.code === \"PROTOCOL_CONNECTION_LOST\" || error.code === \"ECONNRESET\" || error.code === \"ER_TOO_MANY_USER_CONNECTIONS\" || error.message?.includes(\"timeout\")) {\n                connection = null;\n                connectionPromise = null;\n            }\n            console.error(`Database query error (attempt ${attempt}/${retries}):`, {\n                error: error.message,\n                code: error.code,\n                sql: sql.substring(0, 100) + (sql.length > 100 ? \"...\" : \"\")\n            });\n            if (attempt === retries) {\n                if (error.code === \"ER_TOO_MANY_USER_CONNECTIONS\") {\n                    throw new Error(\"Database connection limit reached. Your hosting provider has very strict connection limits. Please try again in a few moments or contact your hosting provider to increase the connection limit.\");\n                }\n                throw new Error(`Database error: ${error.message}`);\n            }\n            // Progressive delay with some randomness to avoid thundering herd\n            const randomDelay = delay + Math.random() * 1000;\n            console.log(`Retrying in ${randomDelay.toFixed(0)}ms...`);\n            await new Promise((resolve)=>setTimeout(resolve, randomDelay));\n            delay *= 1.2; // Slower growth\n        }\n    }\n    throw new Error(\"Max retries exceeded\");\n}\nasync function queryOne(sql, params = []) {\n    const results = await query(sql, params);\n    return results[0] || null;\n}\nasync function testConnection() {\n    try {\n        await query(\"SELECT 1 as test\");\n        return true;\n    } catch (error) {\n        console.error(\"Database connection test failed:\", error);\n        return false;\n    }\n}\nasync function closeConnection() {\n    if (connection) {\n        try {\n            await connection.end();\n            console.log(\"Database connection closed successfully\");\n        } catch (error) {\n            console.error(\"Error closing database connection:\", error);\n        } finally{\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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YWNrOi8vYWRtaW4tcGFuZWwvLi9zcmMvbGliL2RiLXNpbXBsZS50cz9lODAyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBteXNxbCBmcm9tIFwibXlzcWwyL3Byb21pc2VcIjtcclxuXHJcbi8vIFNpbmdsZSBjb25uZWN0aW9uIGFwcHJvYWNoIGZvciBleHRyZW1lbHkgbGltaXRlZCBob3N0aW5nXHJcbmxldCBjb25uZWN0aW9uOiBteXNxbC5Db25uZWN0aW9uIHwgbnVsbCA9IG51bGw7XHJcbmxldCBjb25uZWN0aW9uUHJvbWlzZTogUHJvbWlzZTxteXNxbC5Db25uZWN0aW9uPiB8IG51bGwgPSBudWxsO1xyXG5cclxuY29uc3QgZGJDb25maWcgPSB7XHJcbiAgaG9zdDogcHJvY2Vzcy5lbnYuREJfSE9TVCB8fCBcIjE5OC4zOC45MC41MFwiLFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52LkRCX1BPUlQgfHwgXCIzMzA2XCIpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5EQl9OQU1FIHx8IFwiYm9sYWxvb2NfbWF6ZG9vclwiLFxyXG4gIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgXCJib2xhbG9vY19tYXoxMjNcIixcclxuICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuREJfUEFTU1dPUkQgfHwgXCJFc2JFUjBKZXl0SVhscDQwXCIsXHJcbiAgLy8gT25seSB2YWxpZCBvcHRpb25zIGZvciBteXNxbDIgc2luZ2xlIGNvbm5lY3Rpb25zXHJcbiAgY29ubmVjdFRpbWVvdXQ6IDYwMDAwLFxyXG4gIHRpbWV6b25lOiAnKzAwOjAwJyxcclxufTtcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3Rpb24oKTogUHJvbWlzZTxteXNxbC5Db25uZWN0aW9uPiB7XHJcbiAgLy8gUmV1c2UgZXhpc3RpbmcgY29ubmVjdGlvbiBpZiBhdmFpbGFibGUgYW5kIHN0aWxsIGNvbm5lY3RlZFxyXG4gIGlmIChjb25uZWN0aW9uKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBUZXN0IGlmIGNvbm5lY3Rpb24gaXMgc3RpbGwgYWxpdmUgd2l0aCBhIHNpbXBsZSBxdWVyeVxyXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLnF1ZXJ5KCdTRUxFQ1QgMScpO1xyXG4gICAgICByZXR1cm4gY29ubmVjdGlvbjtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIENvbm5lY3Rpb24gaXMgZGVhZCwgY2xlYW4gaXQgdXBcclxuICAgICAgY29uc29sZS5sb2coJ1tEQl0gRXhpc3RpbmcgY29ubmVjdGlvbiBpcyBkZWFkLCBjcmVhdGluZyBuZXcgb25lLi4uJyk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5lbmQoKTtcclxuICAgICAgfSBjYXRjaCAoY2xvc2VFcnJvcikge1xyXG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnMgd2hlbiBjbG9zaW5nIGRlYWQgY29ubmVjdGlvblxyXG4gICAgICB9XHJcbiAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBJZiB0aGVyZSdzIGFscmVhZHkgYSBjb25uZWN0aW9uIGJlaW5nIGNyZWF0ZWQsIHdhaXQgZm9yIGl0XHJcbiAgaWYgKGNvbm5lY3Rpb25Qcm9taXNlKSB7XHJcbiAgICByZXR1cm4gY29ubmVjdGlvblByb21pc2U7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZygnW0RCXSBDcmVhdGluZyBuZXcgZGF0YWJhc2UgY29ubmVjdGlvbi4uLicpO1xyXG4gIGNvbm5lY3Rpb25Qcm9taXNlID0gbXlzcWwuY3JlYXRlQ29ubmVjdGlvbihkYkNvbmZpZyk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbm5lY3Rpb24gPSBhd2FpdCBjb25uZWN0aW9uUHJvbWlzZTtcclxuICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ1tEQl0gRGF0YWJhc2UgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIFxyXG4gICAgLy8gSGFuZGxlIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICBjb25uZWN0aW9uLm9uKCdlcnJvcicsIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yOicsIGVycik7XHJcbiAgICAgIGlmIChlcnIuY29kZSA9PT0gJ1BST1RPQ09MX0NPTk5FQ1RJT05fTE9TVCcgfHwgZXJyLmNvZGUgPT09ICdFQ09OTlJFU0VUJykge1xyXG4gICAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBjb25uZWN0aW9uO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdbREJdIEZhaWxlZCB0byBjcmVhdGUgZGF0YWJhc2UgY29ubmVjdGlvbjonLCBlcnJvcik7XHJcbiAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeTxUID0gYW55PihcclxuICBzcWw6IHN0cmluZyxcclxuICBwYXJhbXM6IGFueVtdID0gW11cclxuKTogUHJvbWlzZTxUW10+IHtcclxuICBsZXQgcmV0cmllcyA9IDU7IC8vIE1vcmUgcmV0cmllc1xyXG4gIGxldCBkZWxheSA9IDEwMDA7IC8vIFN0YXJ0IHdpdGggc2hvcnRlciBkZWxheVxyXG4gIFxyXG4gIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IHJldHJpZXM7IGF0dGVtcHQrKykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY29ubiA9IGF3YWl0IGdldENvbm5lY3Rpb24oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEV4ZWN1dGUgcXVlcnkgd2l0aCB0aW1lb3V0XHJcbiAgICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgY29ubi5xdWVyeShzcWwsIHBhcmFtcyksXHJcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ1F1ZXJ5IHRpbWVvdXQgYWZ0ZXIgMzAgc2Vjb25kcycpKSwgMzAwMDApXHJcbiAgICAgICAgKVxyXG4gICAgICBdKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBLZWVwIGNvbm5lY3Rpb24gYWxpdmUgZm9yIHJldXNlIC0gZG9uJ3QgY2xvc2UgaXRcclxuICAgICAgcmV0dXJuIHJlc3VsdHMgYXMgVFtdO1xyXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgICAvLyBPbmx5IHJlc2V0IGNvbm5lY3Rpb24gc3RhdGUgb24gY29ubmVjdGlvbi1yZWxhdGVkIGVycm9yc1xyXG4gICAgICBpZiAoZXJyb3IuY29kZSA9PT0gJ1BST1RPQ09MX0NPTk5FQ1RJT05fTE9TVCcgfHwgXHJcbiAgICAgICAgICBlcnJvci5jb2RlID09PSAnRUNPTk5SRVNFVCcgfHwgXHJcbiAgICAgICAgICBlcnJvci5jb2RlID09PSAnRVJfVE9PX01BTllfVVNFUl9DT05ORUNUSU9OUycgfHxcclxuICAgICAgICAgIGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKCd0aW1lb3V0JykpIHtcclxuICAgICAgICBjb25uZWN0aW9uID0gbnVsbDtcclxuICAgICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYERhdGFiYXNlIHF1ZXJ5IGVycm9yIChhdHRlbXB0ICR7YXR0ZW1wdH0vJHtyZXRyaWVzfSk6YCwge1xyXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIGNvZGU6IGVycm9yLmNvZGUsXHJcbiAgICAgICAgc3FsOiBzcWwuc3Vic3RyaW5nKDAsIDEwMCkgKyAoc3FsLmxlbmd0aCA+IDEwMCA/ICcuLi4nIDogJycpLFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChhdHRlbXB0ID09PSByZXRyaWVzKSB7XHJcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdFUl9UT09fTUFOWV9VU0VSX0NPTk5FQ1RJT05TJykge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGxpbWl0IHJlYWNoZWQuIFlvdXIgaG9zdGluZyBwcm92aWRlciBoYXMgdmVyeSBzdHJpY3QgY29ubmVjdGlvbiBsaW1pdHMuIFBsZWFzZSB0cnkgYWdhaW4gaW4gYSBmZXcgbW9tZW50cyBvciBjb250YWN0IHlvdXIgaG9zdGluZyBwcm92aWRlciB0byBpbmNyZWFzZSB0aGUgY29ubmVjdGlvbiBsaW1pdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYXRhYmFzZSBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBQcm9ncmVzc2l2ZSBkZWxheSB3aXRoIHNvbWUgcmFuZG9tbmVzcyB0byBhdm9pZCB0aHVuZGVyaW5nIGhlcmRcclxuICAgICAgY29uc3QgcmFuZG9tRGVsYXkgPSBkZWxheSArIE1hdGgucmFuZG9tKCkgKiAxMDAwO1xyXG4gICAgICBjb25zb2xlLmxvZyhgUmV0cnlpbmcgaW4gJHtyYW5kb21EZWxheS50b0ZpeGVkKDApfW1zLi4uYCk7XHJcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCByYW5kb21EZWxheSkpO1xyXG4gICAgICBkZWxheSAqPSAxLjI7IC8vIFNsb3dlciBncm93dGhcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgdGhyb3cgbmV3IEVycm9yKCdNYXggcmV0cmllcyBleGNlZWRlZCcpO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcXVlcnlPbmU8VCA9IGFueT4oXHJcbiAgc3FsOiBzdHJpbmcsXHJcbiAgcGFyYW1zOiBhbnlbXSA9IFtdXHJcbik6IFByb21pc2U8VCB8IG51bGw+IHtcclxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgcXVlcnk8VD4oc3FsLCBwYXJhbXMpO1xyXG4gIHJldHVybiByZXN1bHRzWzBdIHx8IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0Q29ubmVjdGlvbigpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICB0cnkge1xyXG4gICAgYXdhaXQgcXVlcnkoJ1NFTEVDVCAxIGFzIHRlc3QnKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIHRlc3QgZmFpbGVkOicsIGVycm9yKTtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZUNvbm5lY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgaWYgKGNvbm5lY3Rpb24pIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24uZW5kKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBjb25uZWN0aW9uIGNsb3NlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsb3NpbmcgZGF0YWJhc2UgY29ubmVjdGlvbjonLCBlcnJvcik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBjb25uZWN0aW9uID0gbnVsbDtcclxuICAgICAgY29ubmVjdGlvblByb21pc2UgPSBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsibXlzcWwiLCJjb25uZWN0aW9uIiwiY29ubmVjdGlvblByb21pc2UiLCJkYkNvbmZpZyIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiREJfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIkRCX1BPUlQiLCJkYXRhYmFzZSIsIkRCX05BTUUiLCJ1c2VyIiwiREJfVVNFUiIsInBhc3N3b3JkIiwiREJfUEFTU1dPUkQiLCJjb25uZWN0VGltZW91dCIsInRpbWV6b25lIiwiZ2V0Q29ubmVjdGlvbiIsInF1ZXJ5IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZW5kIiwiY2xvc2VFcnJvciIsImNyZWF0ZUNvbm5lY3Rpb24iLCJvbiIsImVyciIsImNvZGUiLCJzcWwiLCJwYXJhbXMiLCJyZXRyaWVzIiwiZGVsYXkiLCJhdHRlbXB0IiwiY29ubiIsInJlc3VsdHMiLCJQcm9taXNlIiwicmFjZSIsIl8iLCJyZWplY3QiLCJzZXRUaW1lb3V0IiwiRXJyb3IiLCJtZXNzYWdlIiwiaW5jbHVkZXMiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJyYW5kb21EZWxheSIsIk1hdGgiLCJyYW5kb20iLCJ0b0ZpeGVkIiwicmVzb2x2ZSIsInF1ZXJ5T25lIiwidGVzdENvbm5lY3Rpb24iLCJjbG9zZUNvbm5lY3Rpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db-simple.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closePool: () => (/* binding */ closePool),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPoolStatus: () => (/* binding */ getPoolStatus),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var _db_simple__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db-simple */ \"(rsc)/./src/lib/db-simple.ts\");\n// Import both real and mock database approaches\n\n// Always use real database - improved connection handling\nconsole.log(\"[DB] Using REAL database with optimized connection handling\");\n// Export the real database functions\nconst query = _db_simple__WEBPACK_IMPORTED_MODULE_0__.query;\nconst queryOne = _db_simple__WEBPACK_IMPORTED_MODULE_0__.queryOne;\nconst testConnection = _db_simple__WEBPACK_IMPORTED_MODULE_0__.testConnection;\nconst closePool = _db_simple__WEBPACK_IMPORTED_MODULE_0__.closeConnection;\n// Function to get connection status\nfunction getPoolStatus() {\n    return {\n        connectionType: \"single\",\n        connectionLimit: 1,\n        status: \"Using single connection approach for limited hosting\"\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    queryOne,\n    testConnection,\n    closePool,\n    getPoolStatus\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFNM0I7QUFXckIsMERBQTBEO0FBQzFEUSxRQUFRQyxHQUFHLENBQUM7QUFFWixxQ0FBcUM7QUFDOUIsTUFBTVQsUUFBUUMsNkNBQVdBLENBQUM7QUFDMUIsTUFBTUMsV0FBV0MsZ0RBQWNBLENBQUM7QUFDaEMsTUFBTUMsaUJBQWlCQyxzREFBb0JBLENBQUM7QUFDNUMsTUFBTUssWUFBWUgsdURBQXFCQSxDQUFDO0FBRS9DLG9DQUFvQztBQUM3QixTQUFTSTtJQUNkLE9BQU87UUFDTEMsZ0JBQWdCO1FBQ2hCQyxpQkFBaUI7UUFDakJDLFFBQVE7SUFDVjtBQUNGO0FBRUEsaUVBQWU7SUFBRWQ7SUFBT0U7SUFBVUU7SUFBZ0JNO0lBQVdDO0FBQWMsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWRtaW4tcGFuZWwvLi9zcmMvbGliL2RiLnRzPzllNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wb3J0IGJvdGggcmVhbCBhbmQgbW9jayBkYXRhYmFzZSBhcHByb2FjaGVzXHJcbmltcG9ydCB7IFxyXG4gIHF1ZXJ5IGFzIHNpbXBsZVF1ZXJ5LCBcclxuICBxdWVyeU9uZSBhcyBzaW1wbGVRdWVyeU9uZSwgXHJcbiAgdGVzdENvbm5lY3Rpb24gYXMgc2ltcGxlVGVzdENvbm5lY3Rpb24sXHJcbiAgY2xvc2VDb25uZWN0aW9uIGFzIHNpbXBsZUNsb3NlQ29ubmVjdGlvbiBcclxufSBmcm9tICcuL2RiLXNpbXBsZSc7XHJcblxyXG5pbXBvcnQgeyBcclxuICBxdWVyeSBhcyBtb2NrUXVlcnksIFxyXG4gIHF1ZXJ5T25lIGFzIG1vY2tRdWVyeU9uZSwgXHJcbiAgdGVzdENvbm5lY3Rpb24gYXMgbW9ja1Rlc3RDb25uZWN0aW9uLFxyXG4gIGNsb3NlQ29ubmVjdGlvbiBhcyBtb2NrQ2xvc2VDb25uZWN0aW9uIFxyXG59IGZyb20gJy4vZGItbW9jayc7XHJcblxyXG5leHBvcnQgdHlwZSBEYlJlc3VsdDxUPiA9IFQgZXh0ZW5kcyBQcm9taXNlPGluZmVyIFU+ID8gVSA6IG5ldmVyO1xyXG5cclxuLy8gQWx3YXlzIHVzZSByZWFsIGRhdGFiYXNlIC0gaW1wcm92ZWQgY29ubmVjdGlvbiBoYW5kbGluZ1xyXG5jb25zb2xlLmxvZygnW0RCXSBVc2luZyBSRUFMIGRhdGFiYXNlIHdpdGggb3B0aW1pemVkIGNvbm5lY3Rpb24gaGFuZGxpbmcnKTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgcmVhbCBkYXRhYmFzZSBmdW5jdGlvbnNcclxuZXhwb3J0IGNvbnN0IHF1ZXJ5ID0gc2ltcGxlUXVlcnk7XHJcbmV4cG9ydCBjb25zdCBxdWVyeU9uZSA9IHNpbXBsZVF1ZXJ5T25lO1xyXG5leHBvcnQgY29uc3QgdGVzdENvbm5lY3Rpb24gPSBzaW1wbGVUZXN0Q29ubmVjdGlvbjtcclxuZXhwb3J0IGNvbnN0IGNsb3NlUG9vbCA9IHNpbXBsZUNsb3NlQ29ubmVjdGlvbjtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGdldCBjb25uZWN0aW9uIHN0YXR1c1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9vbFN0YXR1cygpIHtcclxuICByZXR1cm4ge1xyXG4gICAgY29ubmVjdGlvblR5cGU6ICdzaW5nbGUnLFxyXG4gICAgY29ubmVjdGlvbkxpbWl0OiAxLFxyXG4gICAgc3RhdHVzOiAnVXNpbmcgc2luZ2xlIGNvbm5lY3Rpb24gYXBwcm9hY2ggZm9yIGxpbWl0ZWQgaG9zdGluZycsXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgcXVlcnlPbmUsIHRlc3RDb25uZWN0aW9uLCBjbG9zZVBvb2wsIGdldFBvb2xTdGF0dXMgfTsgIl0sIm5hbWVzIjpbInF1ZXJ5Iiwic2ltcGxlUXVlcnkiLCJxdWVyeU9uZSIsInNpbXBsZVF1ZXJ5T25lIiwidGVzdENvbm5lY3Rpb24iLCJzaW1wbGVUZXN0Q29ubmVjdGlvbiIsImNsb3NlQ29ubmVjdGlvbiIsInNpbXBsZUNsb3NlQ29ubmVjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJjbG9zZVBvb2wiLCJnZXRQb29sU3RhdHVzIiwiY29ubmVjdGlvblR5cGUiLCJjb25uZWN0aW9uTGltaXQiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/mysql2","vendor-chunks/iconv-lite","vendor-chunks/jose","vendor-chunks/bcryptjs","vendor-chunks/long","vendor-chunks/lru-cache","vendor-chunks/named-placeholders","vendor-chunks/denque","vendor-chunks/is-property","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/generate-function","vendor-chunks/safer-buffer"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&page=%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Fusers%2F%5Bid%5D%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();