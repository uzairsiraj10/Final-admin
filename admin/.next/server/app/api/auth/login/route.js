/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$":
/*!****************************************************!*\
  !*** ./node_modules/mysql2/lib/ sync ^cardinal.*$ ***!
  \****************************************************/
/***/ ((module) => {

function webpackEmptyContext(req) {
	var e = new Error("Cannot find module '" + req + "'");
	e.code = 'MODULE_NOT_FOUND';
	throw e;
}
webpackEmptyContext.keys = () => ([]);
webpackEmptyContext.resolve = webpackEmptyContext;
webpackEmptyContext.id = "(rsc)/./node_modules/mysql2/lib sync recursive ^cardinal.*$";
module.exports = webpackEmptyContext;

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:events":
/*!******************************!*\
  !*** external "node:events" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:events");

/***/ }),

/***/ "node:http":
/*!****************************!*\
  !*** external "node:http" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:http");

/***/ }),

/***/ "node:https":
/*!*****************************!*\
  !*** external "node:https" ***!
  \*****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:https");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:util");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("string_decoder");

/***/ }),

/***/ "timers":
/*!*************************!*\
  !*** external "timers" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("timers");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_mazdoor_admin_src_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/login/route.ts */ \"(rsc)/./src/app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"E:\\\\mazdoor\\\\admin\\\\src\\\\app\\\\api\\\\auth\\\\login\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_mazdoor_admin_src_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj1FJTNBJTVDbWF6ZG9vciU1Q2FkbWluJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1FJTNBJTVDbWF6ZG9vciU1Q2FkbWluJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ1E7QUFDckY7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbi1wYW5lbC8/ZWNhOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJFOlxcXFxtYXpkb29yXFxcXGFkbWluXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGF1dGhcXFxcbG9naW5cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvbG9naW4vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL2xvZ2luXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRTpcXFxcbWF6ZG9vclxcXFxhZG1pblxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXGxvZ2luXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1dGgvbG9naW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/auth/login/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/auth/login/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n\n\nasync function POST(request) {\n    try {\n        const { email, password } = await request.json();\n        const result = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.login)(email, password);\n        // Redirect to dashboard after successful login\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            user: result.user\n        }, {\n            status: 200,\n            headers: {\n                \"Set-Cookie\": `token=${result.token}; Path=/; HttpOnly; SameSite=Lax; Max-Age=${7 * 24 * 60 * 60}`\n            }\n        });\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Invalid credentials\"\n        }, {\n            status: 401\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF3RDtBQUNyQjtBQUU1QixlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRSxHQUFHLE1BQU1GLFFBQVFHLElBQUk7UUFDOUMsTUFBTUMsU0FBUyxNQUFNTixnREFBS0EsQ0FBQ0csT0FBT0M7UUFFbEMsK0NBQStDO1FBQy9DLE9BQU9MLHFEQUFZQSxDQUFDTSxJQUFJLENBQ3RCO1lBQUVFLFNBQVM7WUFBTUMsTUFBTUYsT0FBT0UsSUFBSTtRQUFDLEdBQ25DO1lBQ0VDLFFBQVE7WUFDUkMsU0FBUztnQkFDUCxjQUFjLENBQUMsTUFBTSxFQUFFSixPQUFPSyxLQUFLLENBQUMsMENBQTBDLEVBQUUsSUFBSSxLQUFLLEtBQUssR0FBRyxDQUFDO1lBQ3BHO1FBQ0Y7SUFFSixFQUFFLE9BQU9DLE9BQU87UUFDZCxPQUFPYixxREFBWUEsQ0FBQ00sSUFBSSxDQUN0QjtZQUFFTyxPQUFPO1FBQXNCLEdBQy9CO1lBQUVILFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWRtaW4tcGFuZWwvLi9zcmMvYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzP2QzMWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xyXG5pbXBvcnQgeyBsb2dpbiB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBsb2dpbihlbWFpbCwgcGFzc3dvcmQpO1xyXG4gICAgXHJcbiAgICAvLyBSZWRpcmVjdCB0byBkYXNoYm9hcmQgYWZ0ZXIgc3VjY2Vzc2Z1bCBsb2dpblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IHN1Y2Nlc3M6IHRydWUsIHVzZXI6IHJlc3VsdC51c2VyIH0sXHJcbiAgICAgIHsgXHJcbiAgICAgICAgc3RhdHVzOiAyMDAsXHJcbiAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgJ1NldC1Db29raWUnOiBgdG9rZW49JHtyZXN1bHQudG9rZW59OyBQYXRoPS87IEh0dHBPbmx5OyBTYW1lU2l0ZT1MYXg7IE1heC1BZ2U9JHs3ICogMjQgKiA2MCAqIDYwfWBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogXCJJbnZhbGlkIGNyZWRlbnRpYWxzXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDQwMSB9XHJcbiAgICApO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibG9naW4iLCJQT1NUIiwicmVxdWVzdCIsImVtYWlsIiwicGFzc3dvcmQiLCJqc29uIiwicmVzdWx0Iiwic3VjY2VzcyIsInVzZXIiLCJzdGF0dXMiLCJoZWFkZXJzIiwidG9rZW4iLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   login: () => (/* binding */ login),\n/* harmony export */   logout: () => (/* binding */ logout),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   verifyJWT: () => (/* binding */ verifyJWT),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db */ \"(rsc)/./src/lib/db.ts\");\n\n\n\n\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key\");\nfunction hashPassword(password) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().hash(password, 10);\n}\nfunction verifyPassword(password, hashedPassword) {\n    return bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(password, hashedPassword);\n}\nasync function signJWT(payload, options = {\n    exp: \"7d\"\n}) {\n    try {\n        const token = await new jose__WEBPACK_IMPORTED_MODULE_0__.SignJWT({\n            ...payload\n        }).setProtectedHeader({\n            alg: \"HS256\"\n        }).setIssuedAt().setExpirationTime(options.exp).sign(JWT_SECRET);\n        return token;\n    } catch (error) {\n        console.error(\"JWT signing error:\", error);\n        throw error;\n    }\n}\nasync function verifyJWT(token) {\n    try {\n        const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_0__.jwtVerify)(token, JWT_SECRET);\n        return verified.payload;\n    } catch (error) {\n        console.error(\"JWT verification error:\", error);\n        throw error;\n    }\n}\nasync function getSession(req) {\n    const token = req.cookies.get(\"token\")?.value;\n    if (!token) return null;\n    try {\n        const verified = await verifyJWT(token);\n        return verified;\n    } catch  {\n        return null;\n    }\n}\nasync function getCurrentUser() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    const token = cookieStore.get(\"token\")?.value;\n    if (!token) return null;\n    try {\n        const verified = await verifyJWT(token);\n        const user = await (0,_db__WEBPACK_IMPORTED_MODULE_3__.queryOne)(\"SELECT id, email, name, role FROM users WHERE id = ?\", [\n            parseInt(verified.sub, 10)\n        ]);\n        return user;\n    } catch  {\n        return null;\n    }\n}\nasync function login(email, password) {\n    console.log(\"[AUTH] Starting login process...\");\n    console.log(\"[AUTH] Provided email:\", email);\n    const user = await (0,_db__WEBPACK_IMPORTED_MODULE_3__.queryOne)(\"SELECT id, email, name, role, password_hash FROM users WHERE email = ?\", [\n        email\n    ]);\n    console.log(\"[AUTH] DB query result:\", user);\n    if (!user) {\n        console.warn(\"[AUTH] No user found with that email.\");\n        throw new Error(\"Invalid credentials\");\n    }\n    console.log(\"[AUTH] Stored hash:\", user.password_hash);\n    const isValid = await verifyPassword(password, user.password_hash);\n    console.log(\"[AUTH] Password match:\", isValid);\n    if (!isValid) {\n        console.warn(\"[AUTH] Password did not match.\");\n        throw new Error(\"Invalid credentials\");\n    }\n    const token = await signJWT({\n        sub: user.id.toString(),\n        email: user.email,\n        role: user.role\n    });\n    console.log(\"[AUTH] JWT created:\", token);\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.set(\"token\", token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        expires: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\n    });\n    console.log(\"[AUTH] Token cookie set.\");\n    return {\n        token,\n        user: {\n            id: user.id,\n            email: user.email,\n            name: user.name,\n            role: user.role\n        }\n    };\n}\nasync function logout() {\n    const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_2__.cookies)();\n    cookieStore.delete(\"token\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVFjLEdBQUcsQ0FBQyx1QkFBdUJyQjtJQUVuQyxNQUFNZSxjQUFjaEMscURBQU9BO0lBQzNCZ0MsWUFBWWMsR0FBRyxDQUFDLFNBQVM3QixPQUFPO1FBQzlCOEIsVUFBVTtRQUNWQyxRQUFRM0Msa0JBQXlCO1FBQ2pDNEMsVUFBVTtRQUNWQyxTQUFTLElBQUlDLEtBQUtBLEtBQUtDLEdBQUcsS0FBSyxJQUFJLEtBQUssS0FBSyxLQUFLO0lBQ3BEO0lBRUE1QixRQUFRYyxHQUFHLENBQUM7SUFFWixPQUFPO1FBQ0xyQjtRQUNBZ0IsTUFBTTtZQUNKVSxJQUFJVixLQUFLVSxFQUFFO1lBQ1hOLE9BQU9KLEtBQUtJLEtBQUs7WUFDakJnQixNQUFNcEIsS0FBS29CLElBQUk7WUFDZlIsTUFBTVosS0FBS1ksSUFBSTtRQUNqQjtJQUNGO0FBQ0Y7QUFFTyxlQUFlUztJQUNwQixNQUFNdEIsY0FBY2hDLHFEQUFPQTtJQUMzQmdDLFlBQVl1QixNQUFNLENBQUM7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbi1wYW5lbC8uL3NyYy9saWIvYXV0aC50cz82NjkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNpZ25KV1QsIGp3dFZlcmlmeSB9IGZyb20gXCJqb3NlXCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XHJcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tIFwibmV4dC9oZWFkZXJzXCI7XHJcbmltcG9ydCB7IHR5cGUgTmV4dFJlcXVlc3QgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgcXVlcnlPbmUgfSBmcm9tIFwiLi9kYlwiO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShcclxuICBwcm9jZXNzLmVudi5KV1RfU0VDUkVUIHx8IFwieW91ci1zZWNyZXQta2V5XCJcclxuKTtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XHJcbiAgaWQ6IG51bWJlcjtcclxuICBlbWFpbDogc3RyaW5nO1xyXG4gIG5hbWU6IHN0cmluZztcclxuICByb2xlOiBcImFkbWluXCIgfCBcInN0YWZmXCI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBoYXNoUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlQYXNzd29yZChcclxuICBwYXNzd29yZDogc3RyaW5nLFxyXG4gIGhhc2hlZFBhc3N3b3JkOiBzdHJpbmdcclxuKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgcmV0dXJuIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCBoYXNoZWRQYXNzd29yZCk7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSldUKFxyXG4gIHBheWxvYWQ6IHsgc3ViOiBzdHJpbmc7IGVtYWlsOiBzdHJpbmc7IHJvbGU6IHN0cmluZyB9LFxyXG4gIG9wdGlvbnM6IHsgZXhwOiBzdHJpbmcgfSA9IHsgZXhwOiBcIjdkXCIgfVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBuZXcgU2lnbkpXVCh7IC4uLnBheWxvYWQgfSlcclxuICAgICAgLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogXCJIUzI1NlwiIH0pXHJcbiAgICAgIC5zZXRJc3N1ZWRBdCgpXHJcbiAgICAgIC5zZXRFeHBpcmF0aW9uVGltZShvcHRpb25zLmV4cClcclxuICAgICAgLnNpZ24oSldUX1NFQ1JFVCk7XHJcblxyXG4gICAgcmV0dXJuIHRva2VuO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiSldUIHNpZ25pbmcgZXJyb3I6XCIsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUpXVDxUPih0b2tlbjogc3RyaW5nKTogUHJvbWlzZTxUPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKTtcclxuICAgIHJldHVybiB2ZXJpZmllZC5wYXlsb2FkIGFzIFQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJKV1QgdmVyaWZpY2F0aW9uIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICBjb25zdCB0b2tlbiA9IHJlcS5jb29raWVzLmdldChcInRva2VuXCIpPy52YWx1ZTtcclxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5SldUPHtcclxuICAgICAgc3ViOiBzdHJpbmc7XHJcbiAgICAgIGVtYWlsOiBzdHJpbmc7XHJcbiAgICAgIHJvbGU6IHN0cmluZztcclxuICAgIH0+KHRva2VuKTtcclxuICAgIHJldHVybiB2ZXJpZmllZDtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKCk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldChcInRva2VuXCIpPy52YWx1ZTtcclxuICBpZiAoIXRva2VuKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5SldUPHtcclxuICAgICAgc3ViOiBzdHJpbmc7XHJcbiAgICAgIGVtYWlsOiBzdHJpbmc7XHJcbiAgICAgIHJvbGU6IHN0cmluZztcclxuICAgIH0+KHRva2VuKTtcclxuXHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgcXVlcnlPbmU8VXNlcj4oXHJcbiAgICAgIFwiU0VMRUNUIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSBGUk9NIHVzZXJzIFdIRVJFIGlkID0gP1wiLFxyXG4gICAgICBbcGFyc2VJbnQodmVyaWZpZWQuc3ViLCAxMCldXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiB1c2VyO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9naW4oZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIFN0YXJ0aW5nIGxvZ2luIHByb2Nlc3MuLi5cIik7XHJcbiAgY29uc29sZS5sb2coXCJbQVVUSF0gUHJvdmlkZWQgZW1haWw6XCIsIGVtYWlsKTtcclxuXHJcbiAgY29uc3QgdXNlciA9IGF3YWl0IHF1ZXJ5T25lPFVzZXIgJiB7IHBhc3N3b3JkX2hhc2g6IHN0cmluZyB9PihcclxuICAgIFwiU0VMRUNUIGlkLCBlbWFpbCwgbmFtZSwgcm9sZSwgcGFzc3dvcmRfaGFzaCBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gP1wiLFxyXG4gICAgW2VtYWlsXVxyXG4gICk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIERCIHF1ZXJ5IHJlc3VsdDpcIiwgdXNlcik7XHJcblxyXG4gIGlmICghdXNlcikge1xyXG4gICAgY29uc29sZS53YXJuKFwiW0FVVEhdIE5vIHVzZXIgZm91bmQgd2l0aCB0aGF0IGVtYWlsLlwiKTtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY3JlZGVudGlhbHNcIik7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZyhcIltBVVRIXSBTdG9yZWQgaGFzaDpcIiwgdXNlci5wYXNzd29yZF9oYXNoKTtcclxuXHJcbiAgY29uc3QgaXNWYWxpZCA9IGF3YWl0IHZlcmlmeVBhc3N3b3JkKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkX2hhc2gpO1xyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIFBhc3N3b3JkIG1hdGNoOlwiLCBpc1ZhbGlkKTtcclxuXHJcbiAgaWYgKCFpc1ZhbGlkKSB7XHJcbiAgICBjb25zb2xlLndhcm4oXCJbQVVUSF0gUGFzc3dvcmQgZGlkIG5vdCBtYXRjaC5cIik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGNyZWRlbnRpYWxzXCIpO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBzaWduSldUKHtcclxuICAgIHN1YjogdXNlci5pZC50b1N0cmluZygpLFxyXG4gICAgZW1haWw6IHVzZXIuZW1haWwsXHJcbiAgICByb2xlOiB1c2VyLnJvbGUsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiW0FVVEhdIEpXVCBjcmVhdGVkOlwiLCB0b2tlbik7XHJcblxyXG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gY29va2llcygpO1xyXG4gIGNvb2tpZVN0b3JlLnNldChcInRva2VuXCIsIHRva2VuLCB7XHJcbiAgICBodHRwT25seTogdHJ1ZSxcclxuICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwicHJvZHVjdGlvblwiLFxyXG4gICAgc2FtZVNpdGU6IFwibGF4XCIsXHJcbiAgICBleHBpcmVzOiBuZXcgRGF0ZShEYXRlLm5vdygpICsgNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyA3IGRheXNcclxuICB9KTtcclxuXHJcbiAgY29uc29sZS5sb2coXCJbQVVUSF0gVG9rZW4gY29va2llIHNldC5cIik7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB0b2tlbixcclxuICAgIHVzZXI6IHtcclxuICAgICAgaWQ6IHVzZXIuaWQsXHJcbiAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxyXG4gICAgICBuYW1lOiB1c2VyLm5hbWUsXHJcbiAgICAgIHJvbGU6IHVzZXIucm9sZSxcclxuICAgIH0sXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ291dCgpIHtcclxuICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICBjb29raWVTdG9yZS5kZWxldGUoXCJ0b2tlblwiKTtcclxufVxyXG4iXSwibmFtZXMiOlsiU2lnbkpXVCIsImp3dFZlcmlmeSIsImJjcnlwdCIsImNvb2tpZXMiLCJxdWVyeU9uZSIsIkpXVF9TRUNSRVQiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsInByb2Nlc3MiLCJlbnYiLCJoYXNoUGFzc3dvcmQiLCJwYXNzd29yZCIsImhhc2giLCJ2ZXJpZnlQYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIiwiY29tcGFyZSIsInNpZ25KV1QiLCJwYXlsb2FkIiwib3B0aW9ucyIsImV4cCIsInRva2VuIiwic2V0UHJvdGVjdGVkSGVhZGVyIiwiYWxnIiwic2V0SXNzdWVkQXQiLCJzZXRFeHBpcmF0aW9uVGltZSIsInNpZ24iLCJlcnJvciIsImNvbnNvbGUiLCJ2ZXJpZnlKV1QiLCJ2ZXJpZmllZCIsImdldFNlc3Npb24iLCJyZXEiLCJnZXQiLCJ2YWx1ZSIsImdldEN1cnJlbnRVc2VyIiwiY29va2llU3RvcmUiLCJ1c2VyIiwicGFyc2VJbnQiLCJzdWIiLCJsb2dpbiIsImVtYWlsIiwibG9nIiwid2FybiIsIkVycm9yIiwicGFzc3dvcmRfaGFzaCIsImlzVmFsaWQiLCJpZCIsInRvU3RyaW5nIiwicm9sZSIsInNldCIsImh0dHBPbmx5Iiwic2VjdXJlIiwic2FtZVNpdGUiLCJleHBpcmVzIiwiRGF0ZSIsIm5vdyIsIm5hbWUiLCJsb2dvdXQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db-simple.ts":
/*!******************************!*\
  !*** ./src/lib/db-simple.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closeConnection: () => (/* binding */ closeConnection),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"(rsc)/./node_modules/mysql2/promise.js\");\n\n// Single connection approach for extremely limited hosting\nlet connection = null;\nlet connectionPromise = null;\nconst dbConfig = {\n    host: process.env.DB_HOST || \"198.38.90.50\",\n    port: parseInt(process.env.DB_PORT || \"3306\"),\n    database: process.env.DB_NAME || \"bolalooc_mazdoor\",\n    user: process.env.DB_USER || \"bolalooc_maz123\",\n    password: process.env.DB_PASSWORD || \"EsbER0JeytIXlp40\",\n    // Only valid options for mysql2 single connections\n    connectTimeout: 60000,\n    timezone: \"+00:00\"\n};\nasync function getConnection() {\n    // Always create a fresh connection to avoid connection limit issues\n    // This ensures we don't hold onto stale connections\n    if (connection) {\n        try {\n            await connection.end();\n        } catch (error) {\n        // Ignore errors when closing old connection\n        }\n        connection = null;\n    }\n    if (connectionPromise) {\n        return connectionPromise;\n    }\n    console.log(\"[DB] Creating new database connection...\");\n    connectionPromise = mysql2_promise__WEBPACK_IMPORTED_MODULE_0__.createConnection(dbConfig);\n    try {\n        connection = await connectionPromise;\n        connectionPromise = null;\n        console.log(\"[DB] Database connection established successfully\");\n        // Handle connection errors\n        connection.on(\"error\", (err)=>{\n            console.error(\"Database connection error:\", err);\n            connection = null;\n            connectionPromise = null;\n        });\n        return connection;\n    } catch (error) {\n        console.error(\"[DB] Failed to create database connection:\", error);\n        connectionPromise = null;\n        throw error;\n    }\n}\nasync function query(sql, params = []) {\n    let retries = 5; // More retries\n    let delay = 1000; // Start with shorter delay\n    for(let attempt = 1; attempt <= retries; attempt++){\n        let conn = null;\n        try {\n            conn = await getConnection();\n            // Execute query with timeout\n            const [results] = await Promise.race([\n                conn.query(sql, params),\n                new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"Query timeout after 30 seconds\")), 30000))\n            ]);\n            // Close connection immediately after successful query\n            await conn.end();\n            connection = null;\n            return results;\n        } catch (error) {\n            // Clean up connection on error\n            if (conn) {\n                try {\n                    await conn.end();\n                } catch (closeError) {\n                // Ignore close errors\n                }\n            }\n            connection = null;\n            connectionPromise = null;\n            console.error(`Database query error (attempt ${attempt}/${retries}):`, {\n                error: error.message,\n                code: error.code,\n                sql: sql.substring(0, 100) + (sql.length > 100 ? \"...\" : \"\")\n            });\n            if (attempt === retries) {\n                if (error.code === \"ER_TOO_MANY_USER_CONNECTIONS\") {\n                    throw new Error(\"Database connection limit reached. Your hosting provider has very strict connection limits. Please try again in a few moments or contact your hosting provider to increase the connection limit.\");\n                }\n                throw new Error(`Database error: ${error.message}`);\n            }\n            // Progressive delay with some randomness to avoid thundering herd\n            const randomDelay = delay + Math.random() * 1000;\n            console.log(`Retrying in ${randomDelay.toFixed(0)}ms...`);\n            await new Promise((resolve)=>setTimeout(resolve, randomDelay));\n            delay *= 1.2; // Slower growth\n        }\n    }\n    throw new Error(\"Max retries exceeded\");\n}\nasync function queryOne(sql, params = []) {\n    const results = await query(sql, params);\n    return results[0] || null;\n}\nasync function testConnection() {\n    try {\n        await query(\"SELECT 1 as test\");\n        return true;\n    } catch (error) {\n        console.error(\"Database connection test failed:\", error);\n        return false;\n    }\n}\nasync function closeConnection() {\n    if (connection) {\n        try {\n            await connection.end();\n            console.log(\"Database connection closed successfully\");\n        } catch (error) {\n            console.error(\"Error closing database connection:\", error);\n        } finally{\n            connection = null;\n            connectionPromise = null;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNLENBQUMsZ0JBQWdCLEVBQUVuQixNQUFNcUIsT0FBTyxDQUFDLENBQUM7WUFDcEQ7WUFFQSxrRUFBa0U7WUFDbEUsTUFBTUksY0FBY2YsUUFBUWdCLEtBQUtDLE1BQU0sS0FBSztZQUM1QzFCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLFlBQVksRUFBRXVCLFlBQVlHLE9BQU8sQ0FBQyxHQUFHLEtBQUssQ0FBQztZQUN4RCxNQUFNLElBQUlkLFFBQVFlLENBQUFBLFVBQVdYLFdBQVdXLFNBQVNKO1lBQ2pEZixTQUFTLEtBQUssZ0JBQWdCO1FBQ2hDO0lBQ0Y7SUFFQSxNQUFNLElBQUlTLE1BQU07QUFDbEI7QUFFTyxlQUFlVyxTQUNwQnZCLEdBQVcsRUFDWEMsU0FBZ0IsRUFBRTtJQUVsQixNQUFNSyxVQUFVLE1BQU1QLE1BQVNDLEtBQUtDO0lBQ3BDLE9BQU9LLE9BQU8sQ0FBQyxFQUFFLElBQUk7QUFDdkI7QUFFTyxlQUFla0I7SUFDcEIsSUFBSTtRQUNGLE1BQU16QixNQUFNO1FBQ1osT0FBTztJQUNULEVBQUUsT0FBT04sT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxPQUFPO0lBQ1Q7QUFDRjtBQUVPLGVBQWVnQztJQUNwQixJQUFJcEQsWUFBWTtRQUNkLElBQUk7WUFDRixNQUFNQSxXQUFXbUIsR0FBRztZQUNwQkUsUUFBUUMsR0FBRyxDQUFDO1FBQ2QsRUFBRSxPQUFPRixPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyxzQ0FBc0NBO1FBQ3RELFNBQVU7WUFDUnBCLGFBQWE7WUFDYkMsb0JBQW9CO1FBQ3RCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FkbWluLXBhbmVsLy4vc3JjL2xpYi9kYi1zaW1wbGUudHM/ZTgwMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXlzcWwgZnJvbSBcIm15c3FsMi9wcm9taXNlXCI7XHJcblxyXG4vLyBTaW5nbGUgY29ubmVjdGlvbiBhcHByb2FjaCBmb3IgZXh0cmVtZWx5IGxpbWl0ZWQgaG9zdGluZ1xyXG5sZXQgY29ubmVjdGlvbjogbXlzcWwuQ29ubmVjdGlvbiB8IG51bGwgPSBudWxsO1xyXG5sZXQgY29ubmVjdGlvblByb21pc2U6IFByb21pc2U8bXlzcWwuQ29ubmVjdGlvbj4gfCBudWxsID0gbnVsbDtcclxuXHJcbmNvbnN0IGRiQ29uZmlnID0ge1xyXG4gIGhvc3Q6IHByb2Nlc3MuZW52LkRCX0hPU1QgfHwgXCIxOTguMzguOTAuNTBcIixcclxuICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5EQl9QT1JUIHx8IFwiMzMwNlwiKSxcclxuICBkYXRhYmFzZTogcHJvY2Vzcy5lbnYuREJfTkFNRSB8fCBcImJvbGFsb29jX21hemRvb3JcIixcclxuICB1c2VyOiBwcm9jZXNzLmVudi5EQl9VU0VSIHx8IFwiYm9sYWxvb2NfbWF6MTIzXCIsXHJcbiAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LkRCX1BBU1NXT1JEIHx8IFwiRXNiRVIwSmV5dElYbHA0MFwiLFxyXG4gIC8vIE9ubHkgdmFsaWQgb3B0aW9ucyBmb3IgbXlzcWwyIHNpbmdsZSBjb25uZWN0aW9uc1xyXG4gIGNvbm5lY3RUaW1lb3V0OiA2MDAwMCxcclxuICB0aW1lem9uZTogJyswMDowMCcsXHJcbn07XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRDb25uZWN0aW9uKCk6IFByb21pc2U8bXlzcWwuQ29ubmVjdGlvbj4ge1xyXG4gIC8vIEFsd2F5cyBjcmVhdGUgYSBmcmVzaCBjb25uZWN0aW9uIHRvIGF2b2lkIGNvbm5lY3Rpb24gbGltaXQgaXNzdWVzXHJcbiAgLy8gVGhpcyBlbnN1cmVzIHdlIGRvbid0IGhvbGQgb250byBzdGFsZSBjb25uZWN0aW9uc1xyXG4gIGlmIChjb25uZWN0aW9uKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLmVuZCgpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gSWdub3JlIGVycm9ycyB3aGVuIGNsb3Npbmcgb2xkIGNvbm5lY3Rpb25cclxuICAgIH1cclxuICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgaWYgKGNvbm5lY3Rpb25Qcm9taXNlKSB7XHJcbiAgICByZXR1cm4gY29ubmVjdGlvblByb21pc2U7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZygnW0RCXSBDcmVhdGluZyBuZXcgZGF0YWJhc2UgY29ubmVjdGlvbi4uLicpO1xyXG4gIGNvbm5lY3Rpb25Qcm9taXNlID0gbXlzcWwuY3JlYXRlQ29ubmVjdGlvbihkYkNvbmZpZyk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbm5lY3Rpb24gPSBhd2FpdCBjb25uZWN0aW9uUHJvbWlzZTtcclxuICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ1tEQl0gRGF0YWJhc2UgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIFxyXG4gICAgLy8gSGFuZGxlIGNvbm5lY3Rpb24gZXJyb3JzXHJcbiAgICBjb25uZWN0aW9uLm9uKCdlcnJvcicsIChlcnI6IGFueSkgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yOicsIGVycik7XHJcbiAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgcmV0dXJuIGNvbm5lY3Rpb247XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tEQl0gRmFpbGVkIHRvIGNyZWF0ZSBkYXRhYmFzZSBjb25uZWN0aW9uOicsIGVycm9yKTtcclxuICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5PFQgPSBhbnk+KFxyXG4gIHNxbDogc3RyaW5nLFxyXG4gIHBhcmFtczogYW55W10gPSBbXVxyXG4pOiBQcm9taXNlPFRbXT4ge1xyXG4gIGxldCByZXRyaWVzID0gNTsgLy8gTW9yZSByZXRyaWVzXHJcbiAgbGV0IGRlbGF5ID0gMTAwMDsgLy8gU3RhcnQgd2l0aCBzaG9ydGVyIGRlbGF5XHJcbiAgXHJcbiAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gcmV0cmllczsgYXR0ZW1wdCsrKSB7XHJcbiAgICBsZXQgY29ubjogbXlzcWwuQ29ubmVjdGlvbiB8IG51bGwgPSBudWxsO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29ubiA9IGF3YWl0IGdldENvbm5lY3Rpb24oKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEV4ZWN1dGUgcXVlcnkgd2l0aCB0aW1lb3V0XHJcbiAgICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IFByb21pc2UucmFjZShbXHJcbiAgICAgICAgY29ubi5xdWVyeShzcWwsIHBhcmFtcyksXHJcbiAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gXHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJlamVjdChuZXcgRXJyb3IoJ1F1ZXJ5IHRpbWVvdXQgYWZ0ZXIgMzAgc2Vjb25kcycpKSwgMzAwMDApXHJcbiAgICAgICAgKVxyXG4gICAgICBdKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDbG9zZSBjb25uZWN0aW9uIGltbWVkaWF0ZWx5IGFmdGVyIHN1Y2Nlc3NmdWwgcXVlcnlcclxuICAgICAgYXdhaXQgY29ubi5lbmQoKTtcclxuICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gcmVzdWx0cyBhcyBUW107XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIC8vIENsZWFuIHVwIGNvbm5lY3Rpb24gb24gZXJyb3JcclxuICAgICAgaWYgKGNvbm4pIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgY29ubi5lbmQoKTtcclxuICAgICAgICB9IGNhdGNoIChjbG9zZUVycm9yKSB7XHJcbiAgICAgICAgICAvLyBJZ25vcmUgY2xvc2UgZXJyb3JzXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbm5lY3Rpb24gPSBudWxsO1xyXG4gICAgICBjb25uZWN0aW9uUHJvbWlzZSA9IG51bGw7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmVycm9yKGBEYXRhYmFzZSBxdWVyeSBlcnJvciAoYXR0ZW1wdCAke2F0dGVtcHR9LyR7cmV0cmllc30pOmAsIHtcclxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBjb2RlOiBlcnJvci5jb2RlLFxyXG4gICAgICAgIHNxbDogc3FsLnN1YnN0cmluZygwLCAxMDApICsgKHNxbC5sZW5ndGggPiAxMDAgPyAnLi4uJyA6ICcnKSxcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXR0ZW1wdCA9PT0gcmV0cmllcykge1xyXG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSAnRVJfVE9PX01BTllfVVNFUl9DT05ORUNUSU9OUycpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiBsaW1pdCByZWFjaGVkLiBZb3VyIGhvc3RpbmcgcHJvdmlkZXIgaGFzIHZlcnkgc3RyaWN0IGNvbm5lY3Rpb24gbGltaXRzLiBQbGVhc2UgdHJ5IGFnYWluIGluIGEgZmV3IG1vbWVudHMgb3IgY29udGFjdCB5b3VyIGhvc3RpbmcgcHJvdmlkZXIgdG8gaW5jcmVhc2UgdGhlIGNvbm5lY3Rpb24gbGltaXQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRGF0YWJhc2UgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gUHJvZ3Jlc3NpdmUgZGVsYXkgd2l0aCBzb21lIHJhbmRvbW5lc3MgdG8gYXZvaWQgdGh1bmRlcmluZyBoZXJkXHJcbiAgICAgIGNvbnN0IHJhbmRvbURlbGF5ID0gZGVsYXkgKyBNYXRoLnJhbmRvbSgpICogMTAwMDtcclxuICAgICAgY29uc29sZS5sb2coYFJldHJ5aW5nIGluICR7cmFuZG9tRGVsYXkudG9GaXhlZCgwKX1tcy4uLmApO1xyXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgcmFuZG9tRGVsYXkpKTtcclxuICAgICAgZGVsYXkgKj0gMS4yOyAvLyBTbG93ZXIgZ3Jvd3RoXHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIHRocm93IG5ldyBFcnJvcignTWF4IHJldHJpZXMgZXhjZWVkZWQnKTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5T25lPFQgPSBhbnk+KFxyXG4gIHNxbDogc3RyaW5nLFxyXG4gIHBhcmFtczogYW55W10gPSBbXVxyXG4pOiBQcm9taXNlPFQgfCBudWxsPiB7XHJcbiAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5PFQ+KHNxbCwgcGFyYW1zKTtcclxuICByZXR1cm4gcmVzdWx0c1swXSB8fCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHF1ZXJ5KCdTRUxFQ1QgMSBhcyB0ZXN0Jyk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgY29ubmVjdGlvbiB0ZXN0IGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2xvc2VDb25uZWN0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gIGlmIChjb25uZWN0aW9uKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBjb25uZWN0aW9uLmVuZCgpO1xyXG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbG9zaW5nIGRhdGFiYXNlIGNvbm5lY3Rpb246JywgZXJyb3IpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgY29ubmVjdGlvbiA9IG51bGw7XHJcbiAgICAgIGNvbm5lY3Rpb25Qcm9taXNlID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIm15c3FsIiwiY29ubmVjdGlvbiIsImNvbm5lY3Rpb25Qcm9taXNlIiwiZGJDb25maWciLCJob3N0IiwicHJvY2VzcyIsImVudiIsIkRCX0hPU1QiLCJwb3J0IiwicGFyc2VJbnQiLCJEQl9QT1JUIiwiZGF0YWJhc2UiLCJEQl9OQU1FIiwidXNlciIsIkRCX1VTRVIiLCJwYXNzd29yZCIsIkRCX1BBU1NXT1JEIiwiY29ubmVjdFRpbWVvdXQiLCJ0aW1lem9uZSIsImdldENvbm5lY3Rpb24iLCJlbmQiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVDb25uZWN0aW9uIiwib24iLCJlcnIiLCJxdWVyeSIsInNxbCIsInBhcmFtcyIsInJldHJpZXMiLCJkZWxheSIsImF0dGVtcHQiLCJjb25uIiwicmVzdWx0cyIsIlByb21pc2UiLCJyYWNlIiwiXyIsInJlamVjdCIsInNldFRpbWVvdXQiLCJFcnJvciIsImNsb3NlRXJyb3IiLCJtZXNzYWdlIiwiY29kZSIsInN1YnN0cmluZyIsImxlbmd0aCIsInJhbmRvbURlbGF5IiwiTWF0aCIsInJhbmRvbSIsInRvRml4ZWQiLCJyZXNvbHZlIiwicXVlcnlPbmUiLCJ0ZXN0Q29ubmVjdGlvbiIsImNsb3NlQ29ubmVjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db-simple.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   closePool: () => (/* binding */ closePool),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getPoolStatus: () => (/* binding */ getPoolStatus),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   queryOne: () => (/* binding */ queryOne),\n/* harmony export */   testConnection: () => (/* binding */ testConnection)\n/* harmony export */ });\n/* harmony import */ var _db_simple__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db-simple */ \"(rsc)/./src/lib/db-simple.ts\");\n// Import both real and mock database approaches\n\n// Always use real database - improved connection handling\nconsole.log(\"[DB] Using REAL database with optimized connection handling\");\n// Export the real database functions\nconst query = _db_simple__WEBPACK_IMPORTED_MODULE_0__.query;\nconst queryOne = _db_simple__WEBPACK_IMPORTED_MODULE_0__.queryOne;\nconst testConnection = _db_simple__WEBPACK_IMPORTED_MODULE_0__.testConnection;\nconst closePool = _db_simple__WEBPACK_IMPORTED_MODULE_0__.closeConnection;\n// Function to get connection status\nfunction getPoolStatus() {\n    return {\n        connectionType: \"single\",\n        connectionLimit: 1,\n        status: \"Using single connection approach for limited hosting\"\n    };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    query,\n    queryOne,\n    testConnection,\n    closePool,\n    getPoolStatus\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxnREFBZ0Q7QUFNM0I7QUFXckIsMERBQTBEO0FBQzFEUSxRQUFRQyxHQUFHLENBQUM7QUFFWixxQ0FBcUM7QUFDOUIsTUFBTVQsUUFBUUMsNkNBQVdBLENBQUM7QUFDMUIsTUFBTUMsV0FBV0MsZ0RBQWNBLENBQUM7QUFDaEMsTUFBTUMsaUJBQWlCQyxzREFBb0JBLENBQUM7QUFDNUMsTUFBTUssWUFBWUgsdURBQXFCQSxDQUFDO0FBRS9DLG9DQUFvQztBQUM3QixTQUFTSTtJQUNkLE9BQU87UUFDTEMsZ0JBQWdCO1FBQ2hCQyxpQkFBaUI7UUFDakJDLFFBQVE7SUFDVjtBQUNGO0FBRUEsaUVBQWU7SUFBRWQ7SUFBT0U7SUFBVUU7SUFBZ0JNO0lBQVdDO0FBQWMsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWRtaW4tcGFuZWwvLi9zcmMvbGliL2RiLnRzPzllNGYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gSW1wb3J0IGJvdGggcmVhbCBhbmQgbW9jayBkYXRhYmFzZSBhcHByb2FjaGVzXHJcbmltcG9ydCB7IFxyXG4gIHF1ZXJ5IGFzIHNpbXBsZVF1ZXJ5LCBcclxuICBxdWVyeU9uZSBhcyBzaW1wbGVRdWVyeU9uZSwgXHJcbiAgdGVzdENvbm5lY3Rpb24gYXMgc2ltcGxlVGVzdENvbm5lY3Rpb24sXHJcbiAgY2xvc2VDb25uZWN0aW9uIGFzIHNpbXBsZUNsb3NlQ29ubmVjdGlvbiBcclxufSBmcm9tICcuL2RiLXNpbXBsZSc7XHJcblxyXG5pbXBvcnQgeyBcclxuICBxdWVyeSBhcyBtb2NrUXVlcnksIFxyXG4gIHF1ZXJ5T25lIGFzIG1vY2tRdWVyeU9uZSwgXHJcbiAgdGVzdENvbm5lY3Rpb24gYXMgbW9ja1Rlc3RDb25uZWN0aW9uLFxyXG4gIGNsb3NlQ29ubmVjdGlvbiBhcyBtb2NrQ2xvc2VDb25uZWN0aW9uIFxyXG59IGZyb20gJy4vZGItbW9jayc7XHJcblxyXG5leHBvcnQgdHlwZSBEYlJlc3VsdDxUPiA9IFQgZXh0ZW5kcyBQcm9taXNlPGluZmVyIFU+ID8gVSA6IG5ldmVyO1xyXG5cclxuLy8gQWx3YXlzIHVzZSByZWFsIGRhdGFiYXNlIC0gaW1wcm92ZWQgY29ubmVjdGlvbiBoYW5kbGluZ1xyXG5jb25zb2xlLmxvZygnW0RCXSBVc2luZyBSRUFMIGRhdGFiYXNlIHdpdGggb3B0aW1pemVkIGNvbm5lY3Rpb24gaGFuZGxpbmcnKTtcclxuXHJcbi8vIEV4cG9ydCB0aGUgcmVhbCBkYXRhYmFzZSBmdW5jdGlvbnNcclxuZXhwb3J0IGNvbnN0IHF1ZXJ5ID0gc2ltcGxlUXVlcnk7XHJcbmV4cG9ydCBjb25zdCBxdWVyeU9uZSA9IHNpbXBsZVF1ZXJ5T25lO1xyXG5leHBvcnQgY29uc3QgdGVzdENvbm5lY3Rpb24gPSBzaW1wbGVUZXN0Q29ubmVjdGlvbjtcclxuZXhwb3J0IGNvbnN0IGNsb3NlUG9vbCA9IHNpbXBsZUNsb3NlQ29ubmVjdGlvbjtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGdldCBjb25uZWN0aW9uIHN0YXR1c1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9vbFN0YXR1cygpIHtcclxuICByZXR1cm4ge1xyXG4gICAgY29ubmVjdGlvblR5cGU6ICdzaW5nbGUnLFxyXG4gICAgY29ubmVjdGlvbkxpbWl0OiAxLFxyXG4gICAgc3RhdHVzOiAnVXNpbmcgc2luZ2xlIGNvbm5lY3Rpb24gYXBwcm9hY2ggZm9yIGxpbWl0ZWQgaG9zdGluZycsXHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgeyBxdWVyeSwgcXVlcnlPbmUsIHRlc3RDb25uZWN0aW9uLCBjbG9zZVBvb2wsIGdldFBvb2xTdGF0dXMgfTsgIl0sIm5hbWVzIjpbInF1ZXJ5Iiwic2ltcGxlUXVlcnkiLCJxdWVyeU9uZSIsInNpbXBsZVF1ZXJ5T25lIiwidGVzdENvbm5lY3Rpb24iLCJzaW1wbGVUZXN0Q29ubmVjdGlvbiIsImNsb3NlQ29ubmVjdGlvbiIsInNpbXBsZUNsb3NlQ29ubmVjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJjbG9zZVBvb2wiLCJnZXRQb29sU3RhdHVzIiwiY29ubmVjdGlvblR5cGUiLCJjb25uZWN0aW9uTGltaXQiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose","vendor-chunks/mysql2","vendor-chunks/iconv-lite","vendor-chunks/lru-cache","vendor-chunks/sqlstring","vendor-chunks/seq-queue","vendor-chunks/named-placeholders","vendor-chunks/bcryptjs","vendor-chunks/long","vendor-chunks/safer-buffer","vendor-chunks/is-property","vendor-chunks/generate-function","vendor-chunks/denque"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=E%3A%5Cmazdoor%5Cadmin%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5Cmazdoor%5Cadmin&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();